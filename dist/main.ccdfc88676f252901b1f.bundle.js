(()=>{"use strict";var e,t={189:(e,t,i)=>{var s,a,h,l,n,r,o,d,p,c,m,u,y,g,_,f,L,T,S,w;i(260),i(127);class b extends Phaser.Physics.Arcade.Sprite{constructor(e,t,i,s){super(e,t,i,s),e.add.existing(this),e.physics.add.existing(this),this.setCollideWorldBounds(!0).setBounce(.6).setInteractive().on("pointerdown",(()=>{this.setVelocityY(-400)}))}}class v extends Phaser.Scene{constructor(){super({key:"SplashScene"}),this.timedEvents=[]}preload(){}create(){let{width:e,height:t}=this.sys.game.canvas;this.screenX=e,this.screenY=t,this.backingMusic=this.sound.add("splash_screen_track",{loop:!0}),this.backingMusic.play(),this.logo=new b(this,this.cameras.main.width/2,0,"truffles_splash"),this.timedEvents.push(this.time.delayedCall(4500,this.onEventLogo,["the_hunt_museum"],this)),this.timedEvents.push(this.time.delayedCall(5500,this.onEventLogo,["limerick_museum"],this)),this.timedEvents.push(this.time.delayedCall(6500,this.onEventLogo,["limerick_gallery_of_art"],this)),this.timedEvents.push(this.time.delayedCall(7500,this.onEventLogo,["SETU_Ireland_logo"],this)),this.timedEvents.push(this.time.delayedCall(8500,this.onEventGame,[],this))}update(e,t){}onEventLogo(e){this.logo.destroy(),this.logo=new b(this,this.cameras.main.width/2,0,e)}onEventGame(){this.logo.destroy(),this.scene.start("LEVEL_01"),this.backingMusic.stop()}}class E extends Phaser.Scene{constructor(){super({key:"PreloadScene"})}preload(){this.load.image("truffles_splash","assets/splash/splash.png"),this.load.image("artifact_scene_background","assets/artifacts/img/background.png"),this.load.image("vinnette","assets/level/vinnette.png"),this.load.image("hud_background","assets/level/hud_background.png"),this.load.image("the_hunt_museum","assets/logos/the_hunt_museum.png"),this.load.image("limerick_museum","assets/logos/limerick_city.png"),this.load.image("limerick_gallery_of_art","assets/logos/LCGA.png"),this.load.image("SETU_Ireland_logo","assets/logos/SETU_Ireland_computing.png"),this.load.audio("church_bells",["assets/audio/level/church_bells.mp3","assets/audio/level/church_bells.ogg"]),this.load.audio("splash_screen_track",["assets/audio/splash/splash_screen_track.mp3","assets/audio/splash/splash_screen_track.ogg"]),this.load.audio("level_backing_track",["assets/audio/level/level_backing_track.mp3","assets/audio/level/level_backing_track.ogg"]),this.load.audio("artifact_background",["assets/audio/artifacts/artifact_background.mp3","assets/audio/artifacts/artifact_background.ogg"]),this.load.audio("reward",["assets/audio/level/reward.mp3","assets/audio/level/reward.ogg"]),this.load.audio("punish_one",["assets/audio/level/punish_one.mp3","assets/audio/level/punish_one.ogg"]),this.load.audio("punish_two",["assets/audio/level/punish_two.mp3","assets/audio/level/punish_two.ogg"]),this.load.audio("revived",["assets/audio/level/revived.mp3","assets/audio/level/revived.ogg"]),this.load.audio("under_attack",["assets/audio/level/under_attack.mp3","assets/audio/level/under_attack.ogg"]),this.load.audio("reached_goal",["assets/audio/level/reached_goal.mp3","assets/audio/level/reached_goal.ogg"]),this.load.audio("bridge_open",["assets/audio/level/bridge_opening.mp3","assets/audio/level/bridge_opening.ogg"]),this.load.audio("water_splash",["assets/audio/level/water_splash.mp3","assets/audio/level/water_splash.ogg"]),this.load.audio("a_boy_the_kid",["assets/audio/idioms/a_boy_the_kid.mp3","assets/audio/idioms/a_boy_the_kid.ogg"]),this.load.audio("come_here_i_want_ya",["assets/audio/idioms/come_here_i_want_ya.mp3","assets/audio/idioms/come_here_i_want_ya.ogg"]),this.load.audio("decent",["assets/audio/idioms/decent.mp3","assets/audio/idioms/decent.ogg"]),this.load.audio("dose",["assets/audio/idioms/dose.mp3","assets/audio/idioms/dose.ogg"]),this.load.audio("gawke",["assets/audio/idioms/gawke.mp3","assets/audio/idioms/gawke.ogg"]),this.load.audio("head_like_a_chewed_toffee",["assets/audio/idioms/head_like_a_chewed_toffee.mp3","assets/audio/idioms/head_like_a_chewed_toffee.ogg"]),this.load.audio("mup",["assets/audio/idioms/mup.mp3","assets/audio/idioms/mup.ogg"]),this.load.audio("sca",["assets/audio/idioms/sca.mp3","assets/audio/idioms/sca.ogg"]),this.load.audio("shades",["assets/audio/idioms/shades.mp3","assets/audio/idioms/shades.ogg"]),this.load.audio("sham",["assets/audio/idioms/sham.mp3","assets/audio/idioms/sham.ogg"]),this.load.audio("silent",["assets/audio/idioms/silent.mp3","assets/audio/idioms/silent.ogg"]),this.load.audio("state_of_ya",["assets/audio/idioms/state_of_ya.mp3","assets/audio/idioms/state_of_ya.ogg"]),this.load.audio("story",["assets/audio/idioms/story.mp3","assets/audio/idioms/story.ogg"]),this.load.audio("tackies",["assets/audio/idioms/tackies.mp3","assets/audio/idioms/tackies.ogg"]),this.load.audio("took_a_hopper",["assets/audio/idioms/took_a_hopper.mp3","assets/audio/idioms/took_a_hopper.ogg"]),this.load.audio("unreal",["assets/audio/idioms/unreal.mp3","assets/audio/idioms/unreal.ogg"]),this.load.audio("well_boi_whats_the_craic",["assets/audio/idioms/well_boi_whats_the_craic.mp3","assets/audio/idioms/well_boi_whats_the_craic.ogg"]),this.load.audio("well_kid",["assets/audio/idioms/well_kid.mp3","assets/audio/idioms/well_kid.ogg"]),this.load.audio("well_sham_any_sca",["assets/audio/idioms/well_sham_any_sca.mp3","assets/audio/idioms/well_sham_any_sca.ogg"]),this.load.audio("yurt",["assets/audio/idioms/yurt.mp3","assets/audio/idioms/yurt.ogg"])}create(){this.scene.start("SplashScene")}}class A extends Phaser.GameObjects.Text{constructor(e){super(e,10,50,"",{color:"#EC00D7",fontSize:"48px",fontFamily:"gamefont"}),e.add.existing(this),this.setOrigin(.5)}update(){this.setText("0")}}class D extends Phaser.Scene{constructor(){super({key:"ArtiFactOneScene"})}preload(){this.load.script("fractals","https://static.sketchfab.com/api/sketchfab-viewer-1.12.0.js"),this.load.html("artifact_one","assets/artifacts/artifact_one.html"),this.load.css("artifact_css","./assets/css/artifacts.css")}create(){let{width:e,height:t}=this.sys.game.canvas;this.background=this.add.image(e/2,t/2,"artifact_scene_background"),this.background.setDisplaySize(e,t),this.background.setOrigin(.5,.5),this.element=this.add.dom(this.cameras.main.width/2,100).createFromCache("artifact_one"),this.backingMusic=this.sound.add("artifact_background",{loop:!0}),this.backingMusic.play(),this.nextLevel=new A(this),this.nextLevel.setShadow(3,3),this.nextLevel.setStroke("#414141",3),this.nextLevel.setShadow(2,2,"#333333",2,!0,!0),this.nextLevel.setPosition(.32*e,.85*t),this.nextLevel.on("pointerdown",(()=>this.onClickNextLevel()));let i=document.getElementById("three_muses_game");null!==i&&(i.style.backgroundColor="#333333")}update(){this.nextLevel.update(),this.nextLevel.setText("Next Level"),this.nextLevel.setInteractive(),this.nextLevel.setColor("#ff4d4d")}onClickNextLevel(){this.backingMusic.stop(),this.scene.start("LEVEL_02")}}class k extends Phaser.Scene{constructor(){super({key:"ArtiFactTwoScene"})}preload(){this.load.script("fractals","https://static.sketchfab.com/api/sketchfab-viewer-1.12.0.js"),this.load.html("artifact_two","assets/artifacts/artifact_two.html"),this.load.css("artifact_css","./assets/css/artifacts.css")}create(){let{width:e,height:t}=this.sys.game.canvas;this.background=this.add.image(e/2,t/2,"artifact_scene_background"),this.background.setDisplaySize(e,t),this.background.setOrigin(.5,.5),this.element=this.add.dom(this.cameras.main.width/2,100).createFromCache("artifact_two"),this.backingMusic=this.sound.add("artifact_background",{loop:!0}),this.backingMusic.play(),this.nextLevel=new A(this),this.nextLevel.setShadow(3,3),this.nextLevel.setStroke("#414141",3),this.nextLevel.setShadow(2,2,"#333333",2,!0,!0),this.nextLevel.setPosition(.32*e,.85*t),this.nextLevel.on("pointerdown",(()=>this.onClickNextLevel()));let i=document.getElementById("three_muses_game");null!==i&&(i.style.backgroundColor="#333333")}update(){this.nextLevel.update(),this.nextLevel.setText("Next Level"),this.nextLevel.setInteractive(),this.nextLevel.setColor("#FFFF00")}onClickNextLevel(){this.backingMusic.stop(),this.scene.start("LEVEL_03")}}class I extends Phaser.Scene{constructor(){super({key:"ArtiFactThreeScene"})}preload(){this.load.script("fractals","https://static.sketchfab.com/api/sketchfab-viewer-1.12.0.js"),this.load.html("artifact_three","assets/artifacts/artifact_three.html"),this.load.css("artifact_css","./assets/css/artifacts.css")}create(){let{width:e,height:t}=this.sys.game.canvas;this.background=this.add.image(e/2,t/2,"artifact_scene_background"),this.background.setDisplaySize(e,t),this.background.setOrigin(.5,.5),this.element=this.add.dom(this.cameras.main.width/2,100).createFromCache("artifact_three"),this.backingMusic=this.sound.add("artifact_background",{loop:!0}),this.backingMusic.play(),this.nextLevel=new A(this),this.nextLevel.setShadow(3,3),this.nextLevel.setStroke("#414141",3),this.nextLevel.setShadow(2,2,"#333333",2,!0,!0),this.nextLevel.setPosition(.32*e,.85*t),this.nextLevel.on("pointerdown",(()=>this.onClickNextLevel()));let i=document.getElementById("three_muses_game");null!==i&&(i.style.backgroundColor="#333333")}update(){this.nextLevel.update(),this.nextLevel.setText("Next Level"),this.nextLevel.setInteractive(),this.nextLevel.setColor("#228C22")}onClickNextLevel(){this.backingMusic.stop(),this.scene.start("LEVEL_04")}}class P extends Phaser.Scene{constructor(){super({key:"ArtiFactFourScene"})}preload(){this.load.script("fractals","https://static.sketchfab.com/api/sketchfab-viewer-1.12.0.js"),this.load.html("artifact_four","assets/artifacts/artifact_four.html"),this.load.css("artifact_css","./assets/css/artifacts.css")}create(){let{width:e,height:t}=this.sys.game.canvas;this.background=this.add.image(e/2,t/2,"artifact_scene_background"),this.background.setDisplaySize(e,t),this.background.setOrigin(.5,.5),this.element=this.add.dom(this.cameras.main.width/2,100).createFromCache("artifact_four"),this.backingMusic=this.sound.add("artifact_background",{loop:!0}),this.backingMusic.play(),this.nextLevel=new A(this),this.nextLevel.setShadow(3,3),this.nextLevel.setStroke("#414141",3),this.nextLevel.setShadow(2,2,"#333333",2,!0,!0),this.nextLevel.setPosition(.32*e,.85*t),this.nextLevel.on("pointerdown",(()=>this.onClickNextLevel()));let i=document.getElementById("three_muses_game");null!==i&&(i.style.backgroundColor="#333333")}update(){this.nextLevel.update(),this.nextLevel.setText("Credits"),this.nextLevel.setInteractive(),this.nextLevel.setColor("#FFC0CB")}onClickNextLevel(){this.backingMusic.stop(),this.scene.start("Credits")}}class x extends Phaser.Scene{constructor(){super({key:"Credits"})}preload(){this.load.script("fractals","https://static.sketchfab.com/api/sketchfab-viewer-1.12.0.js"),this.load.html("credits","assets/credits/credits.html"),this.load.css("artifact_css","./assets/css/artifacts.css")}create(){let{width:e,height:t}=this.sys.game.canvas;this.background=this.add.image(e/2,t/2,"artifact_scene_background"),this.background.setDisplaySize(e,t),this.background.setOrigin(.5,.5),this.element=this.add.dom(this.cameras.main.width/2,100).createFromCache("credits"),this.backingMusic=this.sound.add("artifact_background",{loop:!0}),this.backingMusic.play(),this.nextLevel=new A(this),this.nextLevel.setShadow(3,3),this.nextLevel.setStroke("#414141",3),this.nextLevel.setShadow(2,2,"#333333",2,!0,!0),this.nextLevel.setPosition(.28*e,.8*t),this.nextLevel.on("pointerdown",(()=>this.onClickNextLevel()));let i=document.getElementById("three_muses_game");null!==i&&(i.style.backgroundColor="#333333")}update(){this.nextLevel.update(),this.nextLevel.setText("Replay"),this.nextLevel.setInteractive(),this.nextLevel.setColor("#749DAD")}onClickNextLevel(){this.backingMusic.stop(),window.location.reload(),this.scene.start("PreloadScene")}}!function(e){e.IDLE_NEUTRAL="idle",e.IDLE_NOSE="idle_nose",e.IDLE_WAVE="idle_wave",e.WALK_RIGHT="walk_right",e.WALK_LEFT="walk_left",e.WALK_UP="walk_up",e.WALK_DOWN="walk_down",e.UNDER_ATTACK="under_attack",e.EATING="eating",e.EATING_RIGHT="eating_right",e.EATING_LEFT="eating_left",e.EATING_UP="eating_up",e.EATING_DOWN="eating_down",e.MUNCHING_LEFT="munching_left",e.MUNCHING_RIGHT="munching_right",e.MUNCHING_UP="munching_up",e.MUNCHING_DOWN="munching_down",e.EXPIRED="expired",e.REVIVE="revive",e.REVIVED="revived",e.SPLASH="splash",e.REACHED_GOAL="revived"}(s||(s={}));class R{constructor(e,t){this.scene=e,this.spine=t,this.idiomPlayed=!1}}class N extends R{constructor(e,t){super(e,t)}handleInput(e){return e===s.WALK_RIGHT?new O(this.scene,this.spine):e===s.WALK_LEFT?new M(this.scene,this.spine):e===s.WALK_UP?new j(this.scene,this.spine):e===s.WALK_DOWN?new Y(this.scene,this.spine):e===s.UNDER_ATTACK?new B(this.scene,this.spine):e===s.EXPIRED?new G(this.scene,this.spine):e===s.REACHED_GOAL?new q(this.scene,this.spine):void 0}enter(e,t,i){i.setMove(!1),this.animationTime=e,this.idiomTime=e;let a=Phaser.Math.Between(0,39);switch(a){case 1:case 3:case 4:case 5:case 6:case 8:case 9:case 11:case 12:case 14:case 15:case 16:case 17:case 19:case 20:default:this.idiomSound=this.scene.sound.add("silent");break;case 2:this.idiomSound=this.scene.sound.add("story");break;case 7:this.idiomSound=this.scene.sound.add("sca");break;case 10:this.idiomSound=this.scene.sound.add("well_sham_any_sca");break;case 13:this.idiomSound=this.scene.sound.add("a_boy_the_kid");break;case 18:this.idiomSound=this.scene.sound.add("decent")}switch(a=Phaser.Math.Between(0,9),a){case 1:case 4:default:this.spine.play(s.IDLE_NEUTRAL,!0);break;case 2:case 5:this.spine.play(s.IDLE_NOSE,!0);break;case 3:case 6:this.spine.play(s.IDLE_WAVE,!0)}}update(e,t,i){this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.animationTime=0,this.idiomTime=0}}class O extends R{constructor(e,t){super(e,t)}handleInput(e){return e===s.IDLE_NEUTRAL?new N(this.scene,this.spine):e===s.WALK_LEFT?new M(this.scene,this.spine):e===s.WALK_UP?new j(this.scene,this.spine):e===s.WALK_DOWN?new Y(this.scene,this.spine):e===s.EATING?new z(this.scene,this.spine):e===s.UNDER_ATTACK?new B(this.scene,this.spine):e===s.EXPIRED?new G(this.scene,this.spine):e===s.REACHED_GOAL?new q(this.scene,this.spine):e===s.SPLASH?new Z(this.scene,this.spine):void 0}enter(e,t,i){switch(i.setMove(!0),this.animationTime=e,this.idiomTime=e,Phaser.Math.Between(0,20)){case 1:case 2:case 4:case 6:case 7:case 8:case 10:default:this.idiomSound=this.scene.sound.add("silent");break;case 3:case 5:case 9:this.idiomSound=this.scene.sound.add("unreal")}this.spine.play(s.WALK_RIGHT,!0)}update(e,t,i){this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.animationTime=0,this.idiomTime=0}}class M extends R{constructor(e,t){super(e,t)}handleInput(e){return e===s.IDLE_NEUTRAL?new N(this.scene,this.spine):e===s.WALK_RIGHT?new O(this.scene,this.spine):e===s.WALK_UP?new j(this.scene,this.spine):e===s.WALK_DOWN?new Y(this.scene,this.spine):e===s.EATING?new X(this.scene,this.spine):e===s.UNDER_ATTACK?new B(this.scene,this.spine):e===s.EXPIRED?new G(this.scene,this.spine):e===s.REACHED_GOAL?new q(this.scene,this.spine):e===s.SPLASH?new Z(this.scene,this.spine):void 0}enter(e,t,i){switch(i.setMove(!0),this.animationTime=e,this.idiomTime=e,Phaser.Math.Between(0,20)){case 1:case 7:this.idiomSound=this.scene.sound.add("gawke");break;default:this.idiomSound=this.scene.sound.add("silent")}this.spine.play(s.WALK_LEFT,!0)}update(e,t,i){this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.animationTime=0,this.idiomTime=0}}class j extends R{constructor(e,t){super(e,t)}handleInput(e){return e===s.IDLE_NEUTRAL?new N(this.scene,this.spine):e===s.WALK_LEFT?new M(this.scene,this.spine):e===s.WALK_RIGHT?new O(this.scene,this.spine):e===s.WALK_DOWN?new Y(this.scene,this.spine):e===s.EATING?new K(this.scene,this.spine):e===s.UNDER_ATTACK?new B(this.scene,this.spine):e===s.EXPIRED?new G(this.scene,this.spine):e===s.REACHED_GOAL?new q(this.scene,this.spine):e===s.SPLASH?new Z(this.scene,this.spine):void 0}enter(e,t,i){switch(i.setMove(!0),this.animationTime=e,this.idiomTime=e,Phaser.Math.Between(0,20)){case 1:case 5:case 9:this.idiomSound=this.scene.sound.add("yurt");break;default:this.idiomSound=this.scene.sound.add("silent")}this.spine.play(s.WALK_UP,!0)}update(e,t,i){this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.animationTime=0,this.idiomTime=0}}class Y extends R{constructor(e,t){super(e,t)}handleInput(e){return e===s.IDLE_NEUTRAL?new N(this.scene,this.spine):e===s.WALK_LEFT?new M(this.scene,this.spine):e===s.WALK_RIGHT?new O(this.scene,this.spine):e===s.WALK_UP?new j(this.scene,this.spine):e===s.EATING?new U(this.scene,this.spine):e===s.UNDER_ATTACK?new B(this.scene,this.spine):e===s.EXPIRED?new G(this.scene,this.spine):e===s.REACHED_GOAL?new q(this.scene,this.spine):e===s.SPLASH?new Z(this.scene,this.spine):void 0}enter(e,t,i){switch(i.setMove(!0),this.animationTime=e,this.idiomTime=e,Phaser.Math.Between(0,20)){case 1:case 2:case 3:case 4:case 6:case 8:case 9:case 10:default:this.idiomSound=this.scene.sound.add("silent");break;case 5:case 7:this.idiomSound=this.scene.sound.add("yurt")}this.spine.play(s.WALK_DOWN,!0)}update(e,t,i){this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.animationTime=0,this.idiomTime=0}}class X extends R{constructor(e,t){super(e,t)}handleInput(e){return e===s.UNDER_ATTACK?new B(this.scene,this.spine):e===s.EXPIRED?new G(this.scene,this.spine):void 0}enter(e,t,i){switch(i.setMove(!1),this.animationTime=e,this.idiomTime=e,Phaser.Math.Between(0,20)){case 1:case 5:case 9:this.idiomSound=this.scene.sound.add("well_kid");break;default:this.idiomSound=this.scene.sound.add("silent")}this.spine.play(s.EATING_LEFT,!0)}update(e,t,i){var s,a;if(this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.animationElapsed>=i.getEatingDelay()){i.getState();let h=new C(this.scene,this.spine);null===(s=i.getState().getState())||void 0===s||s.exit(e,t,i),i.getState().setState(h),null===(a=i.getState().getState())||void 0===a||a.enter(e,t,i)}this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.idiomElapsed=0,this.idiomTime=0}}class C extends R{constructor(e,t){super(e,t)}handleInput(e){return e===s.UNDER_ATTACK?new B(this.scene,this.spine):e===s.EXPIRED?new G(this.scene,this.spine):void 0}enter(e,t,i){switch(i.setMove(!1),this.animationTime=e,this.idiomTime=e,Phaser.Math.Between(0,20)){case 1:case 5:case 7:this.idiomSound=this.scene.sound.add("unreal");break;default:this.idiomSound=this.scene.sound.add("silent")}this.rewardSound=this.scene.sound.add("reward",{volume:.5}),this.rewardSound.play(),this.spine.play(s.MUNCHING_LEFT,!0)}update(e,t,i){var s,a;if(this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.animationElapsed>i.getMunchingDelay()){i.getState();let h=new N(this.scene,this.spine);null===(s=i.getState().getState())||void 0===s||s.exit(e,t,i),i.getState().setState(h),null===(a=i.getState().getState())||void 0===a||a.enter(e,t,i)}this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.idiomElapsed=0,this.idiomTime=0}}class z extends R{constructor(e,t){super(e,t)}handleInput(e){return e===s.UNDER_ATTACK?new B(this.scene,this.spine):e===s.EXPIRED?new G(this.scene,this.spine):void 0}enter(e,t,i){switch(i.setMove(!1),this.animationTime=e,this.idiomTime=e,Phaser.Math.Between(0,20)){case 1:case 2:case 4:case 5:case 6:case 7:case 8:case 10:default:this.idiomSound=this.scene.sound.add("silent");break;case 3:case 9:this.idiomSound=this.scene.sound.add("come_here_i_want_ya")}this.spine.play(s.EATING_RIGHT,!0)}update(e,t,i){var s,a;if(this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.animationElapsed>=i.getEatingDelay()){i.getState();let h=new V(this.scene,this.spine);null===(s=i.getState().getState())||void 0===s||s.exit(e,t,i),i.getState().setState(h),null===(a=i.getState().getState())||void 0===a||a.enter(e,t,i)}this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.idiomElapsed=0,this.idiomTime=0}}class V extends R{constructor(e,t){super(e,t)}handleInput(e){return e===s.UNDER_ATTACK?new B(this.scene,this.spine):e===s.EXPIRED?new G(this.scene,this.spine):void 0}enter(e,t,i){switch(i.setMove(!1),this.animationTime=e,this.idiomTime=e,Phaser.Math.Between(0,20)){case 1:case 2:case 4:case 6:case 7:case 8:case 10:default:this.idiomSound=this.scene.sound.add("silent");break;case 3:case 5:case 9:this.idiomSound=this.scene.sound.add("unreal")}this.rewardSound=this.scene.sound.add("reward",{volume:.5}),this.rewardSound.play(),this.spine.play(s.MUNCHING_RIGHT,!0)}update(e,t,i){var s,a;if(this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.animationElapsed>i.getMunchingDelay()){i.getState();let h=new N(this.scene,this.spine);null===(s=i.getState().getState())||void 0===s||s.exit(e,t,i),i.getState().setState(h),null===(a=i.getState().getState())||void 0===a||a.enter(e,t,i)}this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.idiomElapsed=0,this.idiomTime=0}}class K extends R{constructor(e,t){super(e,t)}handleInput(e){return e===s.UNDER_ATTACK?new B(this.scene,this.spine):e===s.EXPIRED?new G(this.scene,this.spine):void 0}enter(e,t,i){switch(i.setMove(!1),this.animationTime=e,this.idiomTime=e,Phaser.Math.Between(0,20)){case 1:case 2:case 4:case 5:case 6:case 7:case 8:case 10:default:this.idiomSound=this.scene.sound.add("silent");break;case 3:case 9:this.idiomSound=this.scene.sound.add("come_here_i_want_ya")}this.spine.play(s.EATING_UP,!0)}update(e,t,i){var s,a;if(this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.animationElapsed>=i.getEatingDelay()){i.getState();let h=new F(this.scene,this.spine);null===(s=i.getState().getState())||void 0===s||s.exit(e,t,i),i.getState().setState(h),null===(a=i.getState().getState())||void 0===a||a.enter(e,t,i)}this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.idiomElapsed=0,this.idiomTime=0}}class F extends R{constructor(e,t){super(e,t)}handleInput(e){return e===s.UNDER_ATTACK?new B(this.scene,this.spine):e===s.EXPIRED?new G(this.scene,this.spine):void 0}enter(e,t,i){switch(i.setMove(!1),this.animationTime=e,this.idiomTime=e,Phaser.Math.Between(0,20)){case 1:case 7:default:this.idiomSound=this.scene.sound.add("decent");break;case 2:case 3:case 4:case 5:case 6:case 8:case 9:case 10:this.idiomSound=this.scene.sound.add("silent")}this.rewardSound=this.scene.sound.add("reward",{volume:.5}),this.rewardSound.play(),this.spine.play(s.MUNCHING_UP,!0)}update(e,t,i){var s,a;if(this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.animationElapsed>i.getMunchingDelay()){i.getState();let h=new N(this.scene,this.spine);null===(s=i.getState().getState())||void 0===s||s.exit(e,t,i),i.getState().setState(h),null===(a=i.getState().getState())||void 0===a||a.enter(e,t,i)}this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.idiomElapsed=0,this.idiomTime=0}}class U extends R{constructor(e,t){super(e,t)}handleInput(e){return e===s.UNDER_ATTACK?new B(this.scene,this.spine):e===s.EXPIRED?new G(this.scene,this.spine):void 0}enter(e,t,i){switch(i.setMove(!1),this.animationTime=e,this.idiomTime=e,Phaser.Math.Between(0,20)){case 1:case 3:case 7:this.idiomSound=this.scene.sound.add("come_here_i_want_ya");break;default:this.idiomSound=this.scene.sound.add("silent")}this.spine.play(s.EATING_DOWN,!0)}update(e,t,i){var s,a;if(this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.animationElapsed>=i.getEatingDelay()){i.getState();let h=new W(this.scene,this.spine);null===(s=i.getState().getState())||void 0===s||s.exit(e,t,i),i.getState().setState(h),null===(a=i.getState().getState())||void 0===a||a.enter(e,t,i)}this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.idiomElapsed=0,this.idiomTime=0}}class W extends R{constructor(e,t){super(e,t)}handleInput(e){return e===s.UNDER_ATTACK?new B(this.scene,this.spine):e===s.EXPIRED?new G(this.scene,this.spine):void 0}enter(e,t,i){switch(i.setMove(!1),this.animationTime=e,this.idiomTime=e,Phaser.Math.Between(0,20)){case 1:case 2:case 4:case 6:case 7:case 8:case 10:default:this.idiomSound=this.scene.sound.add("silent");break;case 3:case 5:case 9:this.idiomSound=this.scene.sound.add("unreal")}this.rewardSound=this.scene.sound.add("reward",{volume:.5}),this.rewardSound.play(),this.spine.play(s.MUNCHING_DOWN,!0)}update(e,t,i){var s,a;if(this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.animationElapsed>i.getMunchingDelay()){i.getState();let h=new N(this.scene,this.spine);null===(s=i.getState().getState())||void 0===s||s.exit(e,t,i),i.getState().setState(h),null===(a=i.getState().getState())||void 0===a||a.enter(e,t,i)}this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.idiomElapsed=0,this.idiomTime=0}}class B extends R{constructor(e,t){super(e,t)}handleInput(e){return e===s.WALK_LEFT?new M(this.scene,this.spine):e===s.WALK_RIGHT?new O(this.scene,this.spine):e===s.WALK_UP?new j(this.scene,this.spine):e===s.WALK_DOWN?new Y(this.scene,this.spine):e===s.EXPIRED?new G(this.scene,this.spine):void 0}enter(e,t,i){switch(i.setMove(!1),this.animationTime=e,this.idiomTime=e,Phaser.Math.Between(0,20)){case 1:case 2:case 4:case 6:case 7:case 8:case 10:default:this.idiomSound=this.scene.sound.add("silent");break;case 3:case 5:case 9:this.idiomSound=this.scene.sound.add("head_like_a_chewed_toffee")}this.spine.play(s.UNDER_ATTACK,!0)}update(e,t,i){this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.animationTime=0,this.idiomTime=0}}class G extends R{constructor(e,t){super(e,t)}handleInput(e){}enter(e,t,i){switch(i.setMove(!1),this.animationTime=e,this.idiomTime=e,Phaser.Math.Between(0,20)){case 1:case 3:case 5:case 7:case 9:this.idiomSound=this.scene.sound.add("took_a_hopper");break;default:this.idiomSound=this.scene.sound.add("silent")}this.punishmentSound=this.scene.sound.add("punish_one",{volume:.5}),this.punishmentSound.play(),this.spine.play(s.EXPIRED,!0)}update(e,t,i){var s,a;if(this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.animationElapsed>=i.getExpiredDelay()){i.getState();let h=new H(this.scene,this.spine);null===(s=i.getState().getState())||void 0===s||s.exit(e,t,i),i.getState().setState(h),null===(a=i.getState().getState())||void 0===a||a.enter(e,t,i)}this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.animationTime=0,this.idiomTime=0}}class H extends R{constructor(e,t){super(e,t)}handleInput(e){}enter(e,t,i){switch(i.setMove(!1),this.animationTime=e,this.idiomTime=e,Phaser.Math.Between(0,20)){case 1:case 2:case 4:case 6:case 7:case 8:case 10:default:this.idiomSound=this.scene.sound.add("silent");break;case 3:case 5:case 9:this.idiomSound=this.scene.sound.add("dose")}this.spine.play(s.REVIVE,!0)}update(e,t,i){var s,a;if(this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.animationElapsed>=i.getReviveDelay()){i.getState();let h=new J(this.scene,this.spine);null===(s=i.getState().getState())||void 0===s||s.exit(e,t,i),i.getState().setState(h),null===(a=i.getState().getState())||void 0===a||a.enter(e,t,i)}this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.animationTime=0,this.idiomTime=0}}class J extends R{constructor(e,t){super(e,t)}handleInput(e){}enter(e,t,i){switch(i.setMove(!1),this.animationTime=e,this.idiomTime=e,Phaser.Math.Between(0,20)){case 1:case 2:case 4:case 6:case 7:case 8:case 10:default:this.idiomSound=this.scene.sound.add("silent");break;case 3:case 5:case 9:this.idiomSound=this.scene.sound.add("well_boi_whats_the_craic")}this.punishmentSound=this.scene.sound.add("revived",{volume:.5}),this.punishmentSound.play(),this.spine.play(s.REVIVED,!0)}update(e,t,i){var s,a;if(this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.animationElapsed>=i.getRevivedDelay()){i.getState();let h=new N(this.scene,this.spine);null===(s=i.getState().getState())||void 0===s||s.exit(e,t,i),i.getState().setState(h),null===(a=i.getState().getState())||void 0===a||a.enter(e,t,i)}this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.animationTime=0,this.idiomTime=0}}class Z extends R{constructor(e,t){super(e,t)}handleInput(e){}enter(e,t,i){switch(i.setMove(!1),this.animationTime=e,this.idiomTime=e,Phaser.Math.Between(0,20)){case 1:case 2:case 4:case 6:case 7:case 8:case 10:default:this.idiomSound=this.scene.sound.add("silent");break;case 3:case 5:case 9:this.idiomSound=this.scene.sound.add("state_of_ya")}this.punishmentSound=this.scene.sound.add("water_splash",{volume:.5}),this.punishmentSound.play(),this.spine.play(s.SPLASH,!1)}update(e,t,i){var s,a;if(this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.animationElapsed>=i.getSplashDelay()){i.pushX(),i.getState();let h=new H(this.scene,this.spine);null===(s=i.getState().getState())||void 0===s||s.exit(e,t,i),i.getState().setState(h),null===(a=i.getState().getState())||void 0===a||a.enter(e,t,i)}this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.animationTime=0,this.idiomTime=0}}class q extends R{constructor(e,t){super(e,t)}handleInput(e){}enter(e,t,i){i.setMove(!1),this.animationTime=e,this.idiomTime=e,this.idiomSound=this.scene.sound.add("reached_goal"),this.spine.play(s.REACHED_GOAL,!0)}update(e,t,i){var s,a;if(this.animationElapsed=e-this.animationTime,this.idiomElapsed=e-this.idiomTime,this.animationElapsed>=i.getGoalDelay()){i.getState();let h=new N(this.scene,this.spine);null===(s=i.getState().getState())||void 0===s||s.exit(e,t,i),i.getState().setState(h),null===(a=i.getState().getState())||void 0===a||a.enter(e,t,i)}this.idiomElapsed>=i.getIdiomDelay()&&!this.idiomPlayed&&(this.idiomSound.play(),this.idiomPlayed=!0)}exit(e,t,i){i.setMove(!0),this.animationTime=0,this.idiomTime=0}}class Q{constructor(e,t,i,s){this.state=new N(e,t)}handleInput(e,t,i,s){var a,h,l;let n=null===(a=this.state)||void 0===a?void 0:a.handleInput(e);return void 0!==n&&(null===(h=this.state)||void 0===h||h.exit(t,i,s),this.state=n,null===(l=this.state)||void 0===l||l.enter(t,i,s)),n}update(e,t,i){var s;null===(s=this.state)||void 0===s||s.update(e,t,i)}getState(){return this.state}setState(e){this.state=e}}!function(e){e.PLAY="play",e.LEVEL_COMPLETE="level_complete",e.GAME_COMPLETE="game_complete"}(a||(a={})),function(e){e[e.TIME=100]="TIME"}(h||(h={})),function(e){e.LEVEL_01="LEVEL_01",e.LEVEL_02="LEVEL_02",e.LEVEL_03="LEVEL_03",e.LEVEL_04="LEVEL_04",e.CREDITS="Credits"}(l||(l={})),function(e){e.ArtiFactOneScene="ArtiFactOneScene",e.ArtiFactTwoScene="ArtiFactTwoScene",e.ArtiFactThreeScene="ArtiFactThreeScene",e.ArtiFactFourScene="ArtiFactFourScene",e.CREDITS="Credits"}(n||(n={})),function(e){e[e.CANNON_BALL_COLLISION=-150]="CANNON_BALL_COLLISION",e[e.DIVER_COLLISION=-150]="DIVER_COLLISION",e[e.FRUIT_0=250]="FRUIT_0",e[e.FRUIT_1=300]="FRUIT_1",e[e.FRUIT_2=350]="FRUIT_2",e[e.REACHED_GOAL=1500]="REACHED_GOAL"}(r||(r={})),function(e){e[e.FRUIT=480]="FRUIT"}(o||(o={})),function(e){e[e.DELAY=3e3]="DELAY"}(d||(d={})),function(e){e[e.TILE=551]="TILE"}(p||(p={})),function(e){e[e.TILE=214]="TILE"}(c||(c={})),function(e){e[e.TILE=656]="TILE"}(m||(m={})),function(e){e[e.TILE=344]="TILE"}(u||(u={})),function(e){e[e.ORANGE=0]="ORANGE",e[e.ORANGE_TILE=555]="ORANGE_TILE",e[e.LEMON=1]="LEMON",e[e.LEMON_TILE=503]="LEMON_TILE",e[e.GRAPE=2]="GRAPE",e[e.GRAPE_TILE=607]="GRAPE_TILE"}(y||(y={})),function(e){e[e.START=500]="START",e[e.END=552]="END",e[e.SPEED=.5]="SPEED",e[e.SCALE=.2]="SCALE",e[e.PUSH_SPEED=1]="PUSH_SPEED"}(g||(g={})),function(e){e.WALK_DOWN="walk_front",e.WALK_UP="walk_back",e.PUSH="attack"}(_||(_={})),function(e){e[e.scaleX=1]="scaleX",e[e.scaleY=1]="scaleY",e[e.OFFSETX=-96]="OFFSETX",e[e.OFFSETY=0]="OFFSETY",e[e.PLACE=553]="PLACE",e[e.WALKWAY=396]="WALKWAY"}(f||(f={})),function(e){e.TRANSITIONING="opening",e.OPEN="open"}(L||(L={})),function(e){e[e.SIZE=32]="SIZE"}(T||(T={})),function(e){e[e.X_TILES=35.5]="X_TILES",e[e.Y_TILES=18]="Y_TILES",e[e.SCALE=1.45]="SCALE"}(S||(S={})),function(e){e.IDLE="idle",e.UP="up",e.UP_LEFT="up_left",e.UP_RIGHT="up_right",e.DOWN="down",e.DOWN_LEFT="down_left",e.DOWN_RIGHT="down_right",e.LEFT="left",e.RIGHT="right"}(w||(w={}));class ${constructor(e){this.move=!0,this.reSpawnPosition=e,this.position=e,this.velocityX=new Phaser.Math.Vector2(0,0),this.velocityY=new Phaser.Math.Vector2(0,0),this.idleDelay=1e3,this.eatingDelay=1e3,this.munchingDelay=1e3,this.underAttackDelay=1e3,this.expiredDelay=1e3,this.reviveDelay=1e3,this.revivedDelay=1e3,this.goalDelay=2e3,this.splashDelay=2e3,this.idiomDelay=200,this.scale=.25,this.pushSpeed=new Phaser.Math.Vector2(0,0),this.pushXSpeed=new Phaser.Math.Vector2(-T.SIZE,0)}setMove(e){this.move=e}getMove(){return this.move}setPushSpeed(e){this.pushSpeed.x=-e}respawn(){this.position=this.reSpawnPosition}getIdleDelay(){return this.idleDelay}getEatingDelay(){return this.eatingDelay}getMunchingDelay(){return this.munchingDelay}getUnderAttackDelay(){return this.underAttackDelay}getExpiredDelay(){return this.expiredDelay}getReviveDelay(){return this.reviveDelay}getRevivedDelay(){return this.revivedDelay}getGoalDelay(){return this.goalDelay}getSplashDelay(){return this.splashDelay}getIdiomDelay(){return this.idiomDelay}getX(){return this.position.x}getY(){return this.position.y}setX(e){this.position.x=e}setY(e){this.position.y=e}setVelocityX(e){this.velocityX=e}setVelocityY(e){this.velocityY=e}getVelocityX(){return this.velocityX}getVelocityY(){return this.velocityY}getState(){return this.state}setState(e){this.state=e}getScale(){return this.scale}moveLeft(){this.move&&this.position.subtract(this.velocityX)}moveRight(){this.move&&this.position.add(this.velocityX)}moveUp(){this.move&&this.position.subtract(this.velocityY)}moveDown(){this.move&&this.position.add(this.velocityY)}push(){this.position.add(this.pushSpeed)}pushX(){this.position.add(this.pushXSpeed)}}const ee="truffles",te=s.IDLE_NEUTRAL,ie="cannonball",se="windmill",ae="dpad",he=["orange","lemon","grape"],le="diver",ne="bridge",re="soundbtn",oe="hudtimer",de="hudrecord",pe=["pig","vase","pot","alter"],ce=["red","yellow","green","pink"],me="tree",ue="apple",ye="fish",ge="flowers",_e="flag";class fe extends Phaser.Scene{constructor(){super({key:l.LEVEL_01}),this.hudTimerAnimationNames=[],this.hudTimerAnimationIndex=0,this.hudRecordAnimationNames=[],this.hudRecordAnimationIndex=0,this.trufflesAnimationNames=[],this.trufflesAnimationIndex=0,this.cannonball=[],this.cannonballAnimationNames=[],this.cannonballAnimationIndex=0,this.cannonballPosX=[269,525,781],this.cannonballPosY=[60,60,60],this.cannonballSpeed=2,this.cannonballMoving=[!0,!0,!0],this.fruitAnimationNames=[],this.fruitMarked=[],this.artifact=[],this.artifacts=4,this.key=[],this.keyAnimationNames=[],this.tree=[],this.treeAnimationNames=[],this.apple=[],this.appleAnimationNames=[],this.fish=[],this.fishAnimationNames=[],this.flowers=[],this.flowersAnimationNames=[],this.flags=[],this.flagsAnimationNames=[],this.dpadAnimationIndex=0,this.dpadAnimationNames=[],this.dpad_up=!1,this.dpad_down=!1,this.dpad_left=!1,this.dpad_right=!1,this.fruit=[],this.divers=[],this.diverAnimationNames=[],this.diverAnimationIndex=0,this.diverMove=[],this.tileSize=T.SIZE,this.collectablePoints=0,this.levelScore=0,this.newRecordTime=0,this.screenX=0,this.screenY=0,this.startTime=0,this.frameTime=0,this.newTick=!1,this.fps=60,this.delay=1e3/this.fps}preload(e,t){this.load.image("tileset","assets/level/truffles_level_1_tileset.png"),this.load.tilemapTiledJSON("level","assets/level/truffles_level_1.json"),this.load.setPath("assets/spine/"),this.load.spine(ee,"truffles/truffles_all.json","truffles/truffles_all.atlas"),this.load.spine(le,"diver/diver.json","diver/diver.atlas"),this.load.spine(he[0],"fruits/orange/orange.json","fruits/orange/orange.atlas"),this.load.spine(he[1],"fruits/grape/grape.json","fruits/grape/grape.atlas"),this.load.spine(he[2],"fruits/lemon/lemon.json","fruits/lemon/lemon.atlas"),this.load.spine(ie,"cannonball/cannonball.json","cannonball/cannonball.atlas"),this.load.spine(se,"windmill/windmill.json","windmill/windmill.atlas"),this.load.spine(ae,"dpad/DPad_Final_merge.json","dpad/DPad_Final_merge.atlas"),this.load.spine(re,"sound/sound.json","sound/sound.atlas"),this.load.spine(oe,"timer/timer.json","timer/timer.atlas"),this.load.spine(ne,"drawbridge/drawbridge.json","drawbridge/drawbridge.atlas"),this.load.spine(de,"record/record.json","record/record.atlas"),this.load.spine(pe[0],"collectibles_ui/pig/pig.json","collectibles_ui/pig/pig.atlas"),this.load.spine(pe[1],"collectibles_ui/vase/vase.json","collectibles_ui/vase/vase.atlas"),this.load.spine(pe[2],"collectibles_ui/pot/pot.json","collectibles_ui/pot/pot.atlas"),this.load.spine(pe[3],"collectibles_ui/alter/alter.json","collectibles_ui/alter/alter.atlas"),this.load.spine(ce[0],"keys/red/red_key.json","keys/red/red_key.atlas"),this.load.spine(ce[1],"keys/yellow/yellow_key.json","keys/yellow/yellow_key.atlas"),this.load.spine(ce[2],"keys/green/green_key.json","keys/green/green_key.atlas"),this.load.spine(ce[3],"keys/pink/pink_key.json","keys/pink/pink_key.atlas"),this.load.spine(me,"tree/tree.json","tree/tree.atlas"),this.load.spine(ae,"dpad/DPad_Final_merge.json","dpad/DPad_Final_merge.atlas"),this.load.spine(ue,"appletree/tree2.json","appletree/tree2.atlas"),this.load.spine(ye,"fish/fish.json","fish/fish.atlas"),this.load.spine(ge,"flowers/flowers.json","flowers/flowers.atlas"),this.load.spine(_e,"flag/flag.json","flag/flag.atlas")}create(e,t){var i;let{width:s,height:h}=this.sys.game.canvas;this.screenX=s,this.screenY=h,this.vinnette=this.add.image(s/2,h/2,"vinnette"),this.vinnette.setDisplaySize(s,h),this.vinnette.setOrigin(.5,.5),this.vinnette.setDepth(20),this.hud_background=this.add.image(s/2,.04*h,"hud_background"),this.vinnette.setDisplaySize(s,h),this.vinnette.setOrigin(.5,.5),this.vinnette.setDepth(19),this.player=new $(new Phaser.Math.Vector2(100,360)),this.player.setVelocityX(new Phaser.Math.Vector2(2,0)),this.player.setVelocityY(new Phaser.Math.Vector2(0,2)),this.gameState=a.PLAY,this.fetchRecordedScore(),this.fetchRecordedTime(),this.currentScoreText=new A(this),this.currentScoreText.setShadow(3,3),this.currentScoreText.setStroke("#fff",12),this.currentScoreText.setShadow(2,2,"#333333",2,!0,!0),this.currentScoreText.setDepth(21),this.elapsedTimeText=new A(this),this.elapsedTimeText.setShadow(3,3),this.elapsedTimeText.setStroke("#fff",12),this.elapsedTimeText.setShadow(2,2,"#333333",2,!0,!0),this.elapsedTimeText.setDepth(21),this.recordTimeText=new A(this),this.recordTimeText.setShadow(3,3),this.recordTimeText.setStroke("#fff",12),this.recordTimeText.setShadow(2,2,"#333333",2,!0,!0),this.recordTimeText.setDepth(21),this.hudTimer=this.createSpineObject(te,oe,.67*this.screenX,.001*this.screenY,1,1),this.hudTimer.setDepth(21),this.hudTimer.setScale(.75,.75),this.hudTimerAnimationNames=this.hudTimer.getAnimationList(),this.hudTimer.play(this.hudTimerAnimationNames[1],!0),this.hudRecord=this.createSpineObject(te,de,.46*this.screenX,.001*this.screenY,1,1),this.hudRecord.setDepth(21),this.hudRecord.setScale(.75,.74),this.hudRecordAnimationNames=this.hudRecord.getAnimationList(),this.hudRecord.play(this.hudRecordAnimationNames[0],!0),this.time.addEvent({delay:500,loop:!0,callback:this.fetchRecordedScore,callbackScope:this}),this.setupMap();let n=this.map.width,r=this.map.height;this.backingMusic=this.sound.add("level_backing_track",{loop:!0}),this.backingMusic.play(),this.churchBells=this.sound.add("church_bells",{volume:.5}),this.time.addEvent({delay:6e3,loop:!0,callback:this.playChurchBells,callbackScope:this}),this.bridgeOpening=this.sound.add("bridge_open"),this.truffles=this.createSpineObject(te,ee,this.player.getX(),this.player.getY(),this.player.getScale(),this.player.getScale()),this.truffles.setDepth(0),this.initializeAnimationsState(this.truffles,this.trufflesAnimationNames);for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.diverLayer.getTileAt(t,e);null!=i&&i.index===g.START&&(this.divers.push(this.createSpineObject(_.WALK_DOWN,le,t*this.tileSize,e*this.tileSize+(this.tileSize-1),g.SCALE,g.SCALE)),this.diverMove.push(g.SPEED))}for(let e=0;e<this.divers.length;e++)this.initializeAnimationsState(this.divers[e],this.diverAnimationNames),this.divers[e].setDepth(-1);this.cannonball.push(this.createSpineObject(te,ie,this.cannonballPosX[0],this.cannonballPosY[0],1.2,1.2)),this.cannonball.push(this.createSpineObject(te,ie,this.cannonballPosX[1],this.cannonballPosY[1],1.2,1.2)),this.cannonball.push(this.createSpineObject(te,ie,this.cannonballPosX[2],this.cannonballPosY[2],1.2,1.2));for(let e=0;e<this.cannonball.length;e++)this.initializeAnimationsState(this.cannonball[e],this.cannonballAnimationNames),this.cannonball[e].setDepth(-21);for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.bridgeLayer.getTileAt(t,e);null!=i&&i.index==f.PLACE&&(this.bridge=this.createSpineObject(te,ne,t*this.tileSize+f.OFFSETX,e*this.tileSize+f.OFFSETY,f.scaleX,f.scaleY))}this.bridge.setDepth(-1),this.bridgeOpen=!1,this.windmill=this.createSpineObject(te,se,50,0,1,1),this.windmill.setDepth(-1),this.cursors=this.input.keyboard.createCursorKeys(),this.key_w=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.W),this.key_a=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A),this.key_s=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),this.key_d=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.D),this.key_g=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.G),this.game.device.input.touch&&(this.input.addPointer(2),this.dpad=this.createSpineObject(te,ae,this.tileSize*S.X_TILES,this.tileSize*S.Y_TILES,S.SCALE,S.SCALE),this.dpad.setDepth(21));for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.candyLayer.getTileAt(t,e);null!=i&&(i.index===y.ORANGE_TILE?(this.fruit.push(this.createSpineObject(te,he[0],t*this.tileSize,e*this.tileSize,.7,.7)),this.fruitMarked.push(!1)):i.index===y.LEMON_TILE?(this.fruit.push(this.createSpineObject(te,he[1],t*this.tileSize,e*this.tileSize,.7,.7)),this.fruitMarked.push(!1)):i.index===y.GRAPE_TILE&&(this.fruit.push(this.createSpineObject(te,he[2],t*this.tileSize,e*this.tileSize,.7,.7)),this.fruitMarked.push(!1)))}this.fruitRemaining=this.fruit.length,this.artifact[0]=this.createSpineObject(te,pe[0],.114*this.screenX,.045*this.screenY,.6,.6),this.artifact[1]=this.createSpineObject(te,pe[1],.185*this.screenX,.03*this.screenY,.6,.6),this.artifact[2]=this.createSpineObject(te,pe[2],.24*this.screenX,.04*this.screenY,.6,.6),this.artifact[3]=this.createSpineObject(te,pe[3],.295*this.screenX,.05*this.screenY,.6,.6),this.artifact[0].setDepth(21),this.artifact[1].setDepth(21),this.artifact[2].setDepth(21),this.artifact[3].setDepth(21);for(let e=0;e<this.fruit.length;e++)this.initializeAnimationsState(this.fruit[e],this.fruitAnimationNames);let o=this.sys.settings.key;for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.keyLayer.getTileAt(t,e);null!=i&&395===i.index&&(o===l.LEVEL_01?(this.key[0]=this.createSpineObject(te,ce[0],t*this.tileSize-80,e*this.tileSize-60,.8,.8),this.key[0].setDepth(10)):o===l.LEVEL_02?(this.key[1]=this.createSpineObject(te,ce[1],t*this.tileSize-80,e*this.tileSize-60,.8,.8),this.key[1].setDepth(10)):o===l.LEVEL_03?(this.key[2]=this.createSpineObject(te,ce[2],t*this.tileSize-80,e*this.tileSize-60,.8,.8),this.key[2].setDepth(10)):o===l.LEVEL_04?(this.key[3]=this.createSpineObject(te,ce[3],t*this.tileSize-80,e*this.tileSize-60,.8,.8),this.key[3].setDepth(10)):l.CREDITS)}for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.animatedTrees.getTileAt(t,e);null!=i&&i.index===m.TILE&&this.tree.push(this.createSpineObject(te,me,t*this.tileSize-33,e*this.tileSize-84,.5,.5))}for(let e=0;e<this.tree.length;e++)this.tree[e].setDepth(-1),this.tree[e].play("idle",!0);for(let e=0;e<this.tree.length;e++)this.treeAnimationNames=this.tree[e].getAnimationList();for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.animatedAppleTrees.getTileAt(t,e);null!=i&&i.index===u.TILE&&this.apple.push(this.createSpineObject(te,ue,t*this.tileSize-61,e*this.tileSize-84,.5,.5))}for(let e=0;e<this.apple.length;e++)this.apple[e].setDepth(-18);this.time.addEvent({delay:6e3,loop:!0,callback:this.treeAnimations,callbackScope:this});for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.fishLayer.getTileAt(t,e);null!=i&&657===i.index&&this.fish.push(this.createSpineObject(te,ye,t*this.tileSize,e*this.tileSize-40,1,1))}for(let e=0;e<this.fish.length;e++)this.fish[e].setDepth(19);for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.flowersLayer.getTileAt(t,e);null!=i&&604===i.index&&this.flowers.push(this.createSpineObject(te,ge,t*this.tileSize-10,e*this.tileSize-15,1,1))}for(let e=0;e<this.flowers.length;e++)this.flowers[e].setDepth(-1);for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.flagTopLayer.getTileAt(t,e);null!=i&&447===i.index&&this.flags.push(this.createSpineObject(te,_e,t*this.tileSize+4,e*this.tileSize+2,1,1))}for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.flagLowLayer.getTileAt(t,e);null!=i&&447===i.index&&this.flags.push(this.createSpineObject(te,_e,t*this.tileSize,e*this.tileSize,1,1))}for(let e=0;e<this.flags.length;e++)this.flags[e].setDepth(-9);this.soundMuteUnmuteButton=this.createSpineObject(te,re,.022*this.screenX,.014*this.screenY,1,1),this.soundMuteUnmuteButton.setScale(.8,.8),this.soundMuteUnmuteButton.setDepth(21),this.soundMuteUnmuteButton.setInteractive();let d=this.soundMuteUnmuteButton.getAnimationList(),p=(window.localStorage.getItem("soundState"),!0);"false"===window.localStorage.getItem("soundState")&&(this.game.sound.mute=!0,this.soundMuteUnmuteButton.play(d[1],!0)),this.soundMuteUnmuteButton.on("pointerdown",(()=>1==p?(p=!1,this.soundMuteUnmuteButton.play(d[1],!0),window.localStorage.setItem("soundState",p.toString()),void(this.game.sound.mute=!0)):0==p?(p=!0,this.game.sound.mute=!1,this.soundMuteUnmuteButton.play(d[0],!0),void window.localStorage.setItem("soundState",p.toString())):void 0)),this.playerState=new Q(this,this.truffles,0,0),null===(i=this.playerState.getState())||void 0===i||i.enter(0,0,this.player),this.player.setState(this.playerState),o===l.LEVEL_01||(o===l.LEVEL_02?this.artifact[0].play("pig_filled",!1):o===l.LEVEL_03?(this.artifact[0].play("pig_filled",!1),this.artifact[1].play("vase_filled",!1)):o===l.LEVEL_04?(this.artifact[0].play("pig_filled",!0),this.artifact[1].play("vase_filled",!0),this.artifact[2].play("pot_filled",!1)):l.CREDITS)}update(e,t){var i;if(0===this.startTime&&(this.startTime=e),this.frameTime+=t,this.frameTime>this.delay&&(this.frameTime=0,this.newTick=!0),this.gameState===a.PLAY?this.elapsedLevelTime=e-this.startTime:this.gameState===a.LEVEL_COMPLETE&&(this.hudTimer.play(this.hudTimerAnimationNames[1],!0),Math.round(.001*this.elapsedLevelTime)<=this.bestRecordedTime?this.setRecord(Math.round(.001*this.elapsedLevelTime)):this.newRecordTime=this.bestRecordedTime,this.time.addEvent({delay:d.DELAY,loop:!0,callback:this.levelComplete,callbackScope:this})),this.game.device.input.touch&&this.handleDPad(e,t),this.cannonballMove(),this.trufflesAnimationNames.length,Phaser.Input.Keyboard.JustDown(this.cursors.right)||Phaser.Input.Keyboard.JustDown(this.key_d)?this.player.getState().handleInput(s.WALK_RIGHT,e,t,this.player):Phaser.Input.Keyboard.JustDown(this.cursors.left)||Phaser.Input.Keyboard.JustDown(this.key_a)?this.player.getState().handleInput(s.WALK_LEFT,e,t,this.player):Phaser.Input.Keyboard.JustDown(this.cursors.up)||Phaser.Input.Keyboard.JustDown(this.key_w)?this.player.getState().handleInput(s.WALK_UP,e,t,this.player):(Phaser.Input.Keyboard.JustDown(this.cursors.down)||Phaser.Input.Keyboard.JustDown(this.key_s))&&this.player.getState().handleInput(s.WALK_DOWN,e,t,this.player),this.player.getMove()){if(this.cursors.right.isDown||this.key_d.isDown||this.dpad_right){let e=this.map.worldToTileX(this.player.getX()-this.tileSize/2),t=this.map.worldToTileY(this.player.getY());this.tile=this.collisionLayer.getTileAt(e+1,t),null==this.tile&&(this.player.moveRight(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}if(this.cursors.left.isDown||this.key_a.isDown||this.dpad_left){let e=this.map.worldToTileX(this.player.getX()+this.tileSize/2),t=this.map.worldToTileY(this.player.getY());this.tile=this.collisionLayer.getTileAt(e-1,t),null==this.tile&&(this.player.moveLeft(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}if(this.cursors.up.isDown||this.key_w.isDown||this.dpad_up){let e=this.map.worldToTileX(this.player.getX()),t=this.map.worldToTileY(this.player.getY()+this.tileSize/4);this.tile=this.collisionLayer.getTileAt(e,t-1),null==this.tile&&(this.player.moveUp(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}if(this.cursors.down.isDown||this.key_s.isDown||this.dpad_down){let e=this.map.worldToTileX(this.player.getX()),t=this.map.worldToTileY(this.player.getY()+this.player.getVelocityY().y);this.tile=this.collisionLayer.getTileAt(e,t),null==this.tile&&(this.player.moveDown(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}let i=this.map.worldToTileX(this.player.getX()),a=this.map.worldToTileY(this.player.getY());if(this.tile=this.goalLayer.getTileAt(i,a),null!==this.tile&&this.tile.index===p.TILE&&(this.player.getState().handleInput(s.REACHED_GOAL,e,t,this.player),this.addPoints(r.REACHED_GOAL),this.gsmUpdate(e,t)),this.tile=this.riverLayer.getTileAt(i,a),null!==this.tile&&this.tile.index===c.TILE&&this.player.getState().handleInput(s.SPLASH,e,t,this.player),this.cursors.down.isDown||this.cursors.up.isDown||this.cursors.left.isDown||this.cursors.right.isDown||this.key_w.isDown||this.key_a.isDown||this.key_s.isDown||this.key_d.isDown||this.dpad_up||this.dpad_down||this.dpad_left||this.dpad_right){if(this.newTick)for(let i=0;i<this.fruit.length;i++)!this.fruitMarked[i]&&this.trufflesAABB(this.fruit[i])&&(this.changeAnimation(this.fruit[i],this.fruitAnimationNames,1),this.time.addEvent({delay:o.FRUIT,callback:this.fruitAnimations,callbackScope:this,args:[i,e,t]}),this.fruitMarked[i]=!0,0===i?this.addPoints(r.FRUIT_0):1==i?this.addPoints(r.FRUIT_1):2===i&&this.addPoints(r.FRUIT_2),this.player.getState().handleInput(s.EATING,e,t,this.player))}else this.player.getState().handleInput(s.IDLE_NEUTRAL,e,t,this.player)}if(this.fruitRemaining<=0&&!this.bridgeOpen){this.bridge.play(L.TRANSITIONING,!1),this.bridgeOpen=!0,this.bridgeOpening.play();for(let e=0;e<this.map.height;e++)for(let t=0;t<this.map.width;t++)null!=this.bridgeLayer.getTileAt(t,e)&&this.riverLayer.removeTileAt(t,e)}if(this.newTick){for(let i=0;i<this.cannonball.length;i++)this.trufflesAABB(this.cannonball[i])&&(this.player.getState().handleInput(s.EXPIRED,e,t,this.player),this.addPoints(r.CANNON_BALL_COLLISION));for(let i=0;i<this.divers.length;i++){this.divers[i].y+=this.diverMove[i];const a=this.map.worldToTileX(this.divers[i].x),h=this.map.worldToTileY(this.divers[i].y);this.tile=this.diverLayer.getTileAt(a,h),this.tile.index==g.START?(this.diverMove[i]=g.SPEED,this.divers[i].play(_.WALK_DOWN,!0)):this.tile.index==g.END&&(this.diverMove[i]=-g.SPEED,this.divers[i].play(_.WALK_UP,!0)),this.trufflesDiverCollision(this.divers[i],i)&&(this.player.getState().handleInput(s.EXPIRED,e,t,this.player),this.addPoints(r.DIVER_COLLISION));for(let e=0;e<this.fruit.length;e++)this.sortLayers(this.divers[i],this.fruit[e]);for(let e=0;e<this.cannonball.length;e++)this.sortLayers(this.divers[i],this.cannonball[e])}let i=this.map.worldToTileX(this.player.getX()),a=this.map.worldToTileY(this.player.getY()-this.player.getVelocityY().y);this.tile=this.collisionLayer.getTileAt(i,a),null==this.tile&&(this.player.push(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}null===(i=this.player.getState().getState())||void 0===i||i.update(e,t,this.player),this.currentScoreText.setPosition(.9*this.screenX,.048*this.screenY),this.currentScoreText.update(),this.currentScoreText.setText(" "+this.levelScore+" "),this.currentScoreText.setDepth(21),this.currentScoreText.setFontSize(40),this.elapsedTimeText.setPosition(.76*this.screenX,.048*this.screenY),this.elapsedTimeText.update(),this.elapsedTimeText.setText(" "+Math.round(.001*this.elapsedLevelTime)+" "),this.elapsedTimeText.setDepth(21),this.elapsedTimeText.setFontSize(40),this.recordTimeText.setPosition(.55*this.screenX,.048*this.screenY),this.recordTimeText.update(),this.bestRecordedTime<h.TIME?this.recordTimeText.setText(" "+this.bestRecordedTime+" "):this.recordTimeText.setText(" --:-- "),this.recordTimeText.setDepth(21),this.recordTimeText.setFontSize(40),this.newTick=!1}setupMap(){this.map=this.make.tilemap({key:"level",tileWidth:this.tileSize,tileHeight:this.tileSize}),this.tileset=this.map.addTilesetImage("truffles_level_1_tileset","tileset"),this.waterLayer=this.map.createLayer("map/water/water_depth_00",this.tileset,0,0),this.waterLayer.setDepth(-21),this.groundLayer=this.map.createLayer("map/ground/ground_depth_00",this.tileset,0,0),this.groundLayer.setDepth(-20),this.ground2Layer=this.map.createLayer("map/shadow/shadow_depth_01",this.tileset,0,0),this.ground2Layer.setDepth(-19),this.house2Layer=this.map.createLayer("map/buildings/foreground/house_depth_01/house_layer_2",this.tileset,0,0),this.house2Layer.setDepth(-19),this.house1Layer=this.map.createLayer("map/buildings/foreground/house_depth_01/house_layer_1",this.tileset,0,0),this.house1Layer.setDepth(-19),this.wall1Layer=this.map.createLayer("map/castle/walls/walls_depth_01",this.tileset,0,0),this.wall1Layer.setDepth(-19),this.wall2Layer=this.map.createLayer("map/castle/walls/walls_depth_03",this.tileset,0,0),this.wall2Layer.setDepth(8),this.churchLayer=this.map.createLayer("map/buildings/foreground/church_depth_01/church_01",this.tileset,0,0),this.churchLayer.setDepth(-9),this.castleLayer=this.map.createLayer("map/castle/castle/castle_depth_01",this.tileset,0,0),this.castleLayer.setDepth(-9),this.miscLayer=this.map.createLayer("map/environment_objects/miscellaneous_depth_01",this.tileset,0,0),this.miscLayer.setDepth(-9),this.wallTop1Layer=this.map.createLayer("map/castle/walls/wall_top_depth_01",this.tileset,0,0),this.wallTop1Layer.setDepth(-9),this.wallTop2Layer=this.map.createLayer("map/castle/walls/wall_top_depth_04",this.tileset,0,0),this.wallTop2Layer.setDepth(9),this.house2RoofLayer=this.map.createLayer("map/buildings/background/house_roof_depth_03/house_roof_layer_2",this.tileset,0,0),this.house2RoofLayer.setDepth(8),this.houseRoofLayer=this.map.createLayer("map/buildings/background/house_roof_depth_03/house_roof_layer_1",this.tileset,0,0),this.houseRoofLayer.setDepth(8),this.towerTop1Layer=this.map.createLayer("map/castle/tower/tower_top_depth_01",this.tileset,0,0),this.towerTop1Layer.setDepth(-9),this.towerTop2Layer=this.map.createLayer("map/castle/tower/tower_top_depth_04",this.tileset,0,0),this.towerTop2Layer.setDepth(9),this.churchRoofLayer=this.map.createLayer("map/buildings/background/church_depth_03/church_roof_03",this.tileset,0,0),this.churchRoofLayer.setDepth(-9),this.castleRoofLayer=this.map.createLayer("map/castle/castle/castle_roof_depth_02",this.tileset,0,0),this.castleRoofLayer.setDepth(7),this.animatedTrees=this.map.createLayer("map/environment_objects/animated/tree_01",this.tileset,0,0),this.animatedTrees.setDepth(-9),this.animatedTrees.setVisible(!1),this.miscTop2Layer=this.map.createLayer("map/environment_objects/tree_top_04",this.tileset,0,0),this.miscTop2Layer.setDepth(9),this.miscTop2Layer.setVisible(!1),this.collisionLayer=this.map.createLayer("map/environment_collision/collide_depth_02",this.tileset,0,0),this.collisionLayer.setDepth(7),this.collisionLayer.setVisible(!1),this.keyLayer=this.map.createLayer("map/environment_objects/animated/key",this.tileset,0,0),this.keyLayer.setDepth(9),this.keyLayer.setVisible(!1),this.fishLayer=this.map.createLayer("map/environment_objects/animated/fish_01",this.tileset,0,0),this.fishLayer.setVisible(!1),this.flowersLayer=this.map.createLayer("map/environment_objects/animated/flower_01",this.tileset,0,0),this.flowersLayer.setDepth(-9),this.flowersLayer.setVisible(!1),this.flagTopLayer=this.map.createLayer("map/environment_objects/animated/flag_top_01",this.tileset,0,0),this.flagTopLayer.setVisible(!1),this.flagLowLayer=this.map.createLayer("map/environment_objects/animated/flag_low_03",this.tileset,0,0),this.flagLowLayer.setVisible(!1),this.animatedAppleTrees=this.map.createLayer("map/environment_objects/animated/tree_apple_01",this.tileset,0,0),this.animatedAppleTrees.setVisible(!1),this.bridgeLayer=this.map.createLayer("map/environment_objects/animated/drawbridge_01",this.tileset,0,0),this.bridgeLayer.setVisible(!1),this.riverLayer=this.map.createLayer("map/water/river_00",this.tileset,0,0),this.riverLayer.setVisible(!1);let e=this.sys.settings.key;e===l.LEVEL_01?(this.candyLayer=this.map.createLayer("map/collectables/candies_level1_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level1",this.tileset,0,0)):e===l.LEVEL_02?(this.candyLayer=this.map.createLayer("map/collectables/candies_level2_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level2",this.tileset,0,0)):e===l.LEVEL_03?(this.candyLayer=this.map.createLayer("map/collectables/candies_level3_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level3",this.tileset,0,0)):e===l.LEVEL_04?(this.candyLayer=this.map.createLayer("map/collectables/candies_level4_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level4",this.tileset,0,0)):(this.candyLayer=this.map.createLayer("map/collectables/candies_level1_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level1",this.tileset,0,0)),this.candyLayer.setDepth(7),this.candyLayer.setVisible(!1),this.diverLayer.setDepth(7),this.diverLayer.setVisible(!1),this.goalLayer=this.map.createLayer("map/goal/goal_depth_02",this.tileset,0,0),this.goalLayer.setDepth(7),this.goalLayer.setVisible(!0)}createSpineObject(e,t,i,s,a,h){let l=this.add.spine(i,s,t,e,!0);return l.scaleX=a,l.scaleY=h,l}initializeAnimationsState(e,t){let i=e.getAnimationList();for(let e=0;e<i.length;e++)t.push(i[e])}changeAnimation(e,t,i){const s=t[i];e.play(s,!0)}trufflesAABB(e){let t=!1;return this.player.getX()-this.tileSize/2<e.x+e.scaleX*e.width&&this.player.getX()+this.tileSize/2>e.x&&this.player.getY()-this.tileSize<e.y+e.scaleY*e.height&&this.player.getY()>e.y&&(t=!0),e.y>this.player.getY()?e.setDepth(1):e.setDepth(-1),t}sortLayers(e,t){Math.abs(e.x-t.x)<e.scaleX*e.width&&Math.abs(e.y-t.y)<e.scaleY*e.height&&(e.y<t.y+t.height*t.scaleY?t.setDepth(e.depth+1):t.setDepth(e.depth-1))}trufflesDiverCollision(e,t){let i=!1;return this.map.worldToTileX(this.player.getX())!=this.map.worldToTileX(e.x)&&this.map.worldToTileX(this.player.getX())!=this.map.worldToTileX(e.x)-1||this.map.worldToTileY(this.player.getY())!=this.map.worldToTileY(e.y)||(i=!0,e.play(_.PUSH,!1),this.player.setPushSpeed(g.PUSH_SPEED),this.time.addEvent({delay:800,callback:this.resetDiverAnimations,callbackScope:this,args:[t]})),e.y>this.player.getY()?e.setDepth(2):e.setDepth(-2),i}resetDiverAnimations(e){this.diverMove[e]>0?this.divers[e].play(_.WALK_DOWN,!0):this.divers[e].play(_.WALK_UP,!0),this.player.setPushSpeed(0)}playChurchBells(e,t,i){let s=Phaser.Math.Between(0,24);12!==s&&6!==s||this.churchBells.play()}fruitAnimations(e,t,i){this.changeAnimation(this.fruit[e],this.fruitAnimationNames,2),this.time.addEvent({delay:1e3,callback:this.fruitDelete,callbackScope:this,args:[e,t,i]})}treeAnimations(e,t,i){let s=Phaser.Math.Between(0,24);for(let e=0;e<this.tree.length;e++)18===s||15===s||12===s||9===s||6===s||3===s?"leaf"!==this.tree[e].getCurrentAnimation().name&&this.tree[e].play("leaf",!0):"idle"!==this.tree[e].getCurrentAnimation().name&&this.tree[e].play("idle",!0);for(let e=0;e<this.apple.length;e++)22===s||20===s||16===s||8===s||4===s||2===s?"leaf"!==this.apple[e].getCurrentAnimation().name&&this.apple[e].play("leaf",!0):"idle"!==this.apple[e].getCurrentAnimation().name&&this.apple[e].play("idle",!0)}fruitDelete(e,t,i){const s=this.map.worldToTileX(this.fruit[e].x),a=this.map.worldToTileY(this.fruit[e].y);this.tile=this.candyLayer.getTileAt(s,a),this.map.removeTile(this.tile),this.fruit[e].removeFromDisplayList(),this.fruitRemaining--}cannonballReset(e){this.cannonball[e].setPosition(this.cannonballPosX[e],this.cannonballPosY[e]=40),this.changeAnimation(this.cannonball[e],this.cannonballAnimationNames,1),this.cannonballMoving[e]=!0}cannonballMove(){for(let e=0;e<this.cannonball.length;e++)this.cannonballMoving[e]&&(this.cannonballPosY[e]+=this.cannonballSpeed,this.cannonball[e].setPosition(this.cannonballPosX[e],this.cannonballPosY[e])),this.cannonballPosY[e]>=655&&(this.time.addEvent({delay:600,callback:this.cannonballReset,callbackScope:this,args:[e]}),this.cannonballMoving[e]&&this.changeAnimation(this.cannonball[e],this.cannonballAnimationNames,2),this.cannonballMoving[e]=!1)}setRecord(e){this.newRecordTime=e,this.hudRecord.play(this.hudRecordAnimationNames[1],!0),this.fetchRecordedTime()}addPoints(e){e>0&&(this.collectablePoints+=e)}fetchRecordedTime(){let e=window.localStorage.getItem("time_"+this.sys.settings.key);null!==e?(this.bestRecordedTime=parseInt(e)||0,0===this.bestRecordedTime&&(this.bestRecordedTime=h.TIME)):this.bestRecordedTime=h.TIME,this.newRecordTime<h.TIME?window.localStorage.setItem("time_"+this.sys.settings.key,this.newRecordTime.toString()):window.localStorage.setItem("time_"+this.sys.settings.key,h.TIME.toString())}fetchRecordedScore(){let e=window.localStorage.getItem("score_"+this.sys.settings.key);this.levelScore=null!==e&&parseInt(e)||0,this.levelScore+=this.collectablePoints,this.collectablePoints=0,window.localStorage.setItem("score_"+this.sys.settings.key,this.levelScore.toString())}gsmUpdate(e,t){this.gameState=a.LEVEL_COMPLETE;let i=this.sys.settings.key;i===l.LEVEL_01?(this.artifact[0].play("pig_fill",!1),this.key[0].play("collected",!0)):i===l.LEVEL_02?(this.artifact[1].play("vase_fill",!1),this.key[1].play("collected",!0)):i===l.LEVEL_03?(this.artifact[2].play("pot_fill",!1),this.key[2].play("collected",!0)):i===l.LEVEL_04?(this.artifact[3].play("alter_fill",!1),this.key[3].play("collected",!0)):l.CREDITS}levelComplete(){this.backingMusic.stop();let e=this.sys.settings.key;e===l.LEVEL_01?this.scene.start(n.ArtiFactOneScene):e===l.LEVEL_02?this.scene.start(n.ArtiFactTwoScene):e===l.LEVEL_03?this.scene.start(n.ArtiFactThreeScene):e===l.LEVEL_04?this.scene.start(n.ArtiFactFourScene):e===l.CREDITS&&this.scene.start(n.CREDITS)}handleDPad(e,t){let i=this.input.activePointer;if(i.isDown){let a=i.x,h=i.y,l=this.dpad.x,n=this.dpad.width,r=this.dpad.y,o=this.dpad.height;this.dpad_down=!1,this.dpad_up=!1,this.dpad_left=!1,this.dpad_right=!1,a<l-n/6&&a>l-S.SCALE*n/2&&(this.dpad_left=!0),a>l+n/6&&a<l+S.SCALE*n/2&&(this.dpad_right=!0),h<r-o/6&&h>r-S.SCALE*o/2&&(this.dpad_up=!0),h>r+o/6&&h<r+S.SCALE*o/2&&(this.dpad_down=!0),this.dpad_down?this.dpad_left?(this.player.getState().handleInput(s.WALK_LEFT,e,t,this.player),this.dpad.play(w.DOWN_LEFT,!0)):this.dpad_right?(this.player.getState().handleInput(s.WALK_RIGHT,e,t,this.player),this.dpad.play(w.DOWN_RIGHT,!0)):(this.player.getState().handleInput(s.WALK_DOWN,e,t,this.player),this.dpad.play(w.DOWN,!0)):this.dpad_up?this.dpad_left?(this.player.getState().handleInput(s.WALK_LEFT,e,t,this.player),this.dpad.play(w.UP_LEFT,!0)):this.dpad_right?(this.player.getState().handleInput(s.WALK_RIGHT,e,t,this.player),this.dpad.play(w.UP_RIGHT,!0)):(this.player.getState().handleInput(s.WALK_UP,e,t,this.player),this.dpad.play(w.UP,!0)):this.dpad_left?(this.player.getState().handleInput(s.WALK_LEFT,e,t,this.player),this.dpad.play(w.LEFT,!0)):this.dpad_right&&(this.player.getState().handleInput(s.WALK_RIGHT,e,t,this.player),this.dpad.play(w.RIGHT,!0))}else this.dpad_down=!1,this.dpad_up=!1,this.dpad_left=!1,this.dpad_right=!1,this.dpad.play(w.IDLE,!0)}}const Le="truffles",Te=s.IDLE_NEUTRAL,Se="cannonball",we="windmill",be="dpad",ve=["orange","lemon","grape"],Ee="diver",Ae="bridge",De="soundbtn",ke="hudtimer",Ie="hudrecord",Pe=["pig","vase","pot","alter"],xe=["red","yellow","green","pink"],Re="tree",Ne="apple",Oe="fish",Me="flowers",je="flag";class Ye extends Phaser.Scene{constructor(){super({key:l.LEVEL_02}),this.hudTimerAnimationNames=[],this.hudTimerAnimationIndex=0,this.hudRecordAnimationNames=[],this.hudRecordAnimationIndex=0,this.trufflesAnimationNames=[],this.trufflesAnimationIndex=0,this.cannonball=[],this.cannonballAnimationNames=[],this.cannonballAnimationIndex=0,this.cannonballPosX=[269,525,781],this.cannonballPosY=[60,60,60],this.cannonballSpeed=2,this.cannonballMoving=[!0,!0,!0],this.fruitAnimationNames=[],this.fruitMarked=[],this.artifact=[],this.artifacts=4,this.key=[],this.keyAnimationNames=[],this.tree=[],this.treeAnimationNames=[],this.apple=[],this.appleAnimationNames=[],this.fish=[],this.fishAnimationNames=[],this.flowers=[],this.flowersAnimationNames=[],this.flags=[],this.flagsAnimationNames=[],this.dpadAnimationIndex=0,this.dpadAnimationNames=[],this.dpad_up=!1,this.dpad_down=!1,this.dpad_left=!1,this.dpad_right=!1,this.fruit=[],this.divers=[],this.diverAnimationNames=[],this.diverAnimationIndex=0,this.diverMove=[],this.tileSize=T.SIZE,this.collectablePoints=0,this.levelScore=0,this.newRecordTime=0,this.screenX=0,this.screenY=0,this.startTime=0,this.frameTime=0,this.newTick=!1,this.fps=60,this.delay=1e3/this.fps}preload(e,t){this.load.image("tileset","assets/level/truffles_level_1_tileset.png"),this.load.tilemapTiledJSON("level","assets/level/truffles_level_1.json"),this.load.setPath("assets/spine/"),this.load.spine(Le,"truffles/truffles_all.json","truffles/truffles_all.atlas"),this.load.spine(Ee,"diver/diver.json","diver/diver.atlas"),this.load.spine(ve[0],"fruits/orange/orange.json","fruits/orange/orange.atlas"),this.load.spine(ve[1],"fruits/grape/grape.json","fruits/grape/grape.atlas"),this.load.spine(ve[2],"fruits/lemon/lemon.json","fruits/lemon/lemon.atlas"),this.load.spine(Se,"cannonball/cannonball.json","cannonball/cannonball.atlas"),this.load.spine(we,"windmill/windmill.json","windmill/windmill.atlas"),this.load.spine(be,"dpad/DPad_Final_merge.json","dpad/DPad_Final_merge.atlas"),this.load.spine(De,"sound/sound.json","sound/sound.atlas"),this.load.spine(ke,"timer/timer.json","timer/timer.atlas"),this.load.spine(Ae,"drawbridge/drawbridge.json","drawbridge/drawbridge.atlas"),this.load.spine(Ie,"record/record.json","record/record.atlas"),this.load.spine(Pe[0],"collectibles_ui/pig/pig.json","collectibles_ui/pig/pig.atlas"),this.load.spine(Pe[1],"collectibles_ui/vase/vase.json","collectibles_ui/vase/vase.atlas"),this.load.spine(Pe[2],"collectibles_ui/pot/pot.json","collectibles_ui/pot/pot.atlas"),this.load.spine(Pe[3],"collectibles_ui/alter/alter.json","collectibles_ui/alter/alter.atlas"),this.load.spine(xe[0],"keys/red/red_key.json","keys/red/red_key.atlas"),this.load.spine(xe[1],"keys/yellow/yellow_key.json","keys/yellow/yellow_key.atlas"),this.load.spine(xe[2],"keys/green/green_key.json","keys/green/green_key.atlas"),this.load.spine(xe[3],"keys/pink/pink_key.json","keys/pink/pink_key.atlas"),this.load.spine(Re,"tree/tree.json","tree/tree.atlas"),this.load.spine(be,"dpad/DPad_Final_merge.json","dpad/DPad_Final_merge.atlas"),this.load.spine(Ne,"appletree/tree2.json","appletree/tree2.atlas"),this.load.spine(Oe,"fish/fish.json","fish/fish.atlas"),this.load.spine(Me,"flowers/flowers.json","flowers/flowers.atlas"),this.load.spine(je,"flag/flag.json","flag/flag.atlas")}create(e,t){var i;let{width:s,height:h}=this.sys.game.canvas;this.screenX=s,this.screenY=h,this.vinnette=this.add.image(s/2,h/2,"vinnette"),this.vinnette.setDisplaySize(s,h),this.vinnette.setOrigin(.5,.5),this.vinnette.setDepth(20),this.hud_background=this.add.image(s/2,.04*h,"hud_background"),this.vinnette.setDisplaySize(s,h),this.vinnette.setOrigin(.5,.5),this.vinnette.setDepth(19),this.player=new $(new Phaser.Math.Vector2(100,360)),this.player.setVelocityX(new Phaser.Math.Vector2(2,0)),this.player.setVelocityY(new Phaser.Math.Vector2(0,2)),this.gameState=a.PLAY,this.fetchRecordedScore(),this.fetchRecordedTime(),this.currentScoreText=new A(this),this.currentScoreText.setShadow(3,3),this.currentScoreText.setStroke("#fff",12),this.currentScoreText.setShadow(2,2,"#333333",2,!0,!0),this.currentScoreText.setDepth(21),this.elapsedTimeText=new A(this),this.elapsedTimeText.setShadow(3,3),this.elapsedTimeText.setStroke("#fff",12),this.elapsedTimeText.setShadow(2,2,"#333333",2,!0,!0),this.elapsedTimeText.setDepth(21),this.recordTimeText=new A(this),this.recordTimeText.setShadow(3,3),this.recordTimeText.setStroke("#fff",12),this.recordTimeText.setShadow(2,2,"#333333",2,!0,!0),this.recordTimeText.setDepth(21),this.hudTimer=this.createSpineObject(Te,ke,.67*this.screenX,.001*this.screenY,1,1),this.hudTimer.setDepth(21),this.hudTimer.setScale(.75,.75),this.hudTimerAnimationNames=this.hudTimer.getAnimationList(),this.hudTimer.play(this.hudTimerAnimationNames[1],!0),this.hudRecord=this.createSpineObject(Te,Ie,.46*this.screenX,.001*this.screenY,1,1),this.hudRecord.setDepth(21),this.hudRecord.setScale(.75,.74),this.hudRecordAnimationNames=this.hudRecord.getAnimationList(),this.hudRecord.play(this.hudRecordAnimationNames[0],!0),this.time.addEvent({delay:500,loop:!0,callback:this.fetchRecordedScore,callbackScope:this}),this.setupMap();let n=this.map.width,r=this.map.height;this.backingMusic=this.sound.add("level_backing_track",{loop:!0}),this.backingMusic.play(),this.churchBells=this.sound.add("church_bells",{volume:.5}),this.time.addEvent({delay:6e3,loop:!0,callback:this.playChurchBells,callbackScope:this}),this.bridgeOpening=this.sound.add("bridge_open"),this.truffles=this.createSpineObject(Te,Le,this.player.getX(),this.player.getY(),this.player.getScale(),this.player.getScale()),this.truffles.setDepth(0),this.initializeAnimationsState(this.truffles,this.trufflesAnimationNames);for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.diverLayer.getTileAt(t,e);null!=i&&i.index===g.START&&(this.divers.push(this.createSpineObject(_.WALK_DOWN,Ee,t*this.tileSize,e*this.tileSize+(this.tileSize-1),g.SCALE,g.SCALE)),this.diverMove.push(g.SPEED))}for(let e=0;e<this.divers.length;e++)this.initializeAnimationsState(this.divers[e],this.diverAnimationNames),this.divers[e].setDepth(-1);this.cannonball.push(this.createSpineObject(Te,Se,this.cannonballPosX[0],this.cannonballPosY[0],1.2,1.2)),this.cannonball.push(this.createSpineObject(Te,Se,this.cannonballPosX[1],this.cannonballPosY[1],1.2,1.2)),this.cannonball.push(this.createSpineObject(Te,Se,this.cannonballPosX[2],this.cannonballPosY[2],1.2,1.2));for(let e=0;e<this.cannonball.length;e++)this.initializeAnimationsState(this.cannonball[e],this.cannonballAnimationNames),this.cannonball[e].setDepth(-21);for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.bridgeLayer.getTileAt(t,e);null!=i&&i.index==f.PLACE&&(this.bridge=this.createSpineObject(Te,Ae,t*this.tileSize+f.OFFSETX,e*this.tileSize+f.OFFSETY,f.scaleX,f.scaleY))}this.bridge.setDepth(-1),this.bridgeOpen=!1,this.windmill=this.createSpineObject(Te,we,50,0,1,1),this.windmill.setDepth(-1),this.cursors=this.input.keyboard.createCursorKeys(),this.key_w=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.W),this.key_a=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A),this.key_s=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),this.key_d=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.D),this.key_g=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.G),this.game.device.input.touch&&(this.input.addPointer(2),this.dpad=this.createSpineObject(Te,be,this.tileSize*S.X_TILES,this.tileSize*S.Y_TILES,S.SCALE,S.SCALE),this.dpad.setDepth(21));for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.candyLayer.getTileAt(t,e);null!=i&&(i.index===y.ORANGE_TILE?(this.fruit.push(this.createSpineObject(Te,ve[0],t*this.tileSize,e*this.tileSize,.7,.7)),this.fruitMarked.push(!1)):i.index===y.LEMON_TILE?(this.fruit.push(this.createSpineObject(Te,ve[1],t*this.tileSize,e*this.tileSize,.7,.7)),this.fruitMarked.push(!1)):i.index===y.GRAPE_TILE&&(this.fruit.push(this.createSpineObject(Te,ve[2],t*this.tileSize,e*this.tileSize,.7,.7)),this.fruitMarked.push(!1)))}this.fruitRemaining=this.fruit.length,this.artifact[0]=this.createSpineObject(Te,Pe[0],.114*this.screenX,.045*this.screenY,.6,.6),this.artifact[1]=this.createSpineObject(Te,Pe[1],.185*this.screenX,.03*this.screenY,.6,.6),this.artifact[2]=this.createSpineObject(Te,Pe[2],.24*this.screenX,.04*this.screenY,.6,.6),this.artifact[3]=this.createSpineObject(Te,Pe[3],.295*this.screenX,.05*this.screenY,.6,.6),this.artifact[0].setDepth(21),this.artifact[1].setDepth(21),this.artifact[2].setDepth(21),this.artifact[3].setDepth(21);for(let e=0;e<this.fruit.length;e++)this.initializeAnimationsState(this.fruit[e],this.fruitAnimationNames);let o=this.sys.settings.key;for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.keyLayer.getTileAt(t,e);null!=i&&395===i.index&&(o===l.LEVEL_01?(this.key[0]=this.createSpineObject(Te,xe[0],t*this.tileSize-80,e*this.tileSize-60,.8,.8),this.key[0].setDepth(10)):o===l.LEVEL_02?(this.key[1]=this.createSpineObject(Te,xe[1],t*this.tileSize-80,e*this.tileSize-60,.8,.8),this.key[1].setDepth(10)):o===l.LEVEL_03?(this.key[2]=this.createSpineObject(Te,xe[2],t*this.tileSize-80,e*this.tileSize-60,.8,.8),this.key[2].setDepth(10)):o===l.LEVEL_04?(this.key[3]=this.createSpineObject(Te,xe[3],t*this.tileSize-80,e*this.tileSize-60,.8,.8),this.key[3].setDepth(10)):l.CREDITS)}for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.animatedTrees.getTileAt(t,e);null!=i&&i.index===m.TILE&&this.tree.push(this.createSpineObject(Te,Re,t*this.tileSize-33,e*this.tileSize-84,.5,.5))}for(let e=0;e<this.tree.length;e++)this.tree[e].setDepth(-1),this.tree[e].play("idle",!0);for(let e=0;e<this.tree.length;e++)this.treeAnimationNames=this.tree[e].getAnimationList();for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.animatedAppleTrees.getTileAt(t,e);null!=i&&i.index===u.TILE&&this.apple.push(this.createSpineObject(Te,Ne,t*this.tileSize-61,e*this.tileSize-84,.5,.5))}for(let e=0;e<this.apple.length;e++)this.apple[e].setDepth(-18);this.time.addEvent({delay:6e3,loop:!0,callback:this.treeAnimations,callbackScope:this});for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.fishLayer.getTileAt(t,e);null!=i&&657===i.index&&this.fish.push(this.createSpineObject(Te,Oe,t*this.tileSize,e*this.tileSize-40,1,1))}for(let e=0;e<this.fish.length;e++)this.fish[e].setDepth(19);for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.flowersLayer.getTileAt(t,e);null!=i&&604===i.index&&this.flowers.push(this.createSpineObject(Te,Me,t*this.tileSize-10,e*this.tileSize-15,1,1))}for(let e=0;e<this.flowers.length;e++)this.flowers[e].setDepth(-1);for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.flagTopLayer.getTileAt(t,e);null!=i&&447===i.index&&this.flags.push(this.createSpineObject(Te,je,t*this.tileSize+4,e*this.tileSize+2,1,1))}for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.flagLowLayer.getTileAt(t,e);null!=i&&447===i.index&&this.flags.push(this.createSpineObject(Te,je,t*this.tileSize,e*this.tileSize,1,1))}for(let e=0;e<this.flags.length;e++)this.flags[e].setDepth(-9);this.soundMuteUnmuteButton=this.createSpineObject(Te,De,.022*this.screenX,.014*this.screenY,1,1),this.soundMuteUnmuteButton.setScale(.8,.8),this.soundMuteUnmuteButton.setDepth(21),this.soundMuteUnmuteButton.setInteractive();let d=this.soundMuteUnmuteButton.getAnimationList(),p=(window.localStorage.getItem("soundState"),!0);"false"===window.localStorage.getItem("soundState")&&(this.game.sound.mute=!0,this.soundMuteUnmuteButton.play(d[1],!0)),this.soundMuteUnmuteButton.on("pointerdown",(()=>1==p?(p=!1,this.soundMuteUnmuteButton.play(d[1],!0),window.localStorage.setItem("soundState",p.toString()),void(this.game.sound.mute=!0)):0==p?(p=!0,this.game.sound.mute=!1,this.soundMuteUnmuteButton.play(d[0],!0),void window.localStorage.setItem("soundState",p.toString())):void 0)),this.playerState=new Q(this,this.truffles,0,0),null===(i=this.playerState.getState())||void 0===i||i.enter(0,0,this.player),this.player.setState(this.playerState),o===l.LEVEL_01||(o===l.LEVEL_02?this.artifact[0].play("pig_filled",!1):o===l.LEVEL_03?(this.artifact[0].play("pig_filled",!1),this.artifact[1].play("vase_filled",!1)):o===l.LEVEL_04?(this.artifact[0].play("pig_filled",!0),this.artifact[1].play("vase_filled",!0),this.artifact[2].play("pot_filled",!1)):l.CREDITS)}update(e,t){var i;if(0===this.startTime&&(this.startTime=e),this.frameTime+=t,this.frameTime>this.delay&&(this.frameTime=0,this.newTick=!0),this.gameState===a.PLAY?this.elapsedLevelTime=e-this.startTime:this.gameState===a.LEVEL_COMPLETE&&(this.hudTimer.play(this.hudTimerAnimationNames[1],!0),Math.round(.001*this.elapsedLevelTime)<=this.bestRecordedTime?this.setRecord(Math.round(.001*this.elapsedLevelTime)):this.newRecordTime=this.bestRecordedTime,this.time.addEvent({delay:d.DELAY,loop:!0,callback:this.levelComplete,callbackScope:this})),this.game.device.input.touch&&this.handleDPad(e,t),this.cannonballMove(),this.trufflesAnimationNames.length,Phaser.Input.Keyboard.JustDown(this.cursors.right)||Phaser.Input.Keyboard.JustDown(this.key_d)?this.player.getState().handleInput(s.WALK_RIGHT,e,t,this.player):Phaser.Input.Keyboard.JustDown(this.cursors.left)||Phaser.Input.Keyboard.JustDown(this.key_a)?this.player.getState().handleInput(s.WALK_LEFT,e,t,this.player):Phaser.Input.Keyboard.JustDown(this.cursors.up)||Phaser.Input.Keyboard.JustDown(this.key_w)?this.player.getState().handleInput(s.WALK_UP,e,t,this.player):(Phaser.Input.Keyboard.JustDown(this.cursors.down)||Phaser.Input.Keyboard.JustDown(this.key_s))&&this.player.getState().handleInput(s.WALK_DOWN,e,t,this.player),this.player.getMove()){if(this.cursors.right.isDown||this.key_d.isDown||this.dpad_right){let e=this.map.worldToTileX(this.player.getX()-this.tileSize/2),t=this.map.worldToTileY(this.player.getY());this.tile=this.collisionLayer.getTileAt(e+1,t),null==this.tile&&(this.player.moveRight(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}if(this.cursors.left.isDown||this.key_a.isDown||this.dpad_left){let e=this.map.worldToTileX(this.player.getX()+this.tileSize/2),t=this.map.worldToTileY(this.player.getY());this.tile=this.collisionLayer.getTileAt(e-1,t),null==this.tile&&(this.player.moveLeft(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}if(this.cursors.up.isDown||this.key_w.isDown||this.dpad_up){let e=this.map.worldToTileX(this.player.getX()),t=this.map.worldToTileY(this.player.getY()+this.tileSize/4);this.tile=this.collisionLayer.getTileAt(e,t-1),null==this.tile&&(this.player.moveUp(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}if(this.cursors.down.isDown||this.key_s.isDown||this.dpad_down){let e=this.map.worldToTileX(this.player.getX()),t=this.map.worldToTileY(this.player.getY()+this.player.getVelocityY().y);this.tile=this.collisionLayer.getTileAt(e,t),null==this.tile&&(this.player.moveDown(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}let i=this.map.worldToTileX(this.player.getX()),a=this.map.worldToTileY(this.player.getY());if(this.tile=this.goalLayer.getTileAt(i,a),null!==this.tile&&this.tile.index===p.TILE&&(this.player.getState().handleInput(s.REACHED_GOAL,e,t,this.player),this.addPoints(r.REACHED_GOAL),this.gsmUpdate(e,t)),this.tile=this.riverLayer.getTileAt(i,a),null!==this.tile&&this.tile.index===c.TILE&&this.player.getState().handleInput(s.SPLASH,e,t,this.player),this.cursors.down.isDown||this.cursors.up.isDown||this.cursors.left.isDown||this.cursors.right.isDown||this.key_w.isDown||this.key_a.isDown||this.key_s.isDown||this.key_d.isDown||this.dpad_up||this.dpad_down||this.dpad_left||this.dpad_right){if(this.newTick)for(let i=0;i<this.fruit.length;i++)!this.fruitMarked[i]&&this.trufflesAABB(this.fruit[i])&&(this.changeAnimation(this.fruit[i],this.fruitAnimationNames,1),this.time.addEvent({delay:o.FRUIT,callback:this.fruitAnimations,callbackScope:this,args:[i,e,t]}),this.fruitMarked[i]=!0,0===i?this.addPoints(r.FRUIT_0):1==i?this.addPoints(r.FRUIT_1):2===i&&this.addPoints(r.FRUIT_2),this.player.getState().handleInput(s.EATING,e,t,this.player))}else this.player.getState().handleInput(s.IDLE_NEUTRAL,e,t,this.player)}if(this.fruitRemaining<=0&&!this.bridgeOpen){this.bridge.play(L.TRANSITIONING,!1),this.bridgeOpen=!0,this.bridgeOpening.play();for(let e=0;e<this.map.height;e++)for(let t=0;t<this.map.width;t++)null!=this.bridgeLayer.getTileAt(t,e)&&this.riverLayer.removeTileAt(t,e)}if(this.newTick){for(let i=0;i<this.cannonball.length;i++)this.trufflesAABB(this.cannonball[i])&&(this.player.getState().handleInput(s.EXPIRED,e,t,this.player),this.addPoints(r.CANNON_BALL_COLLISION));for(let i=0;i<this.divers.length;i++){this.divers[i].y+=this.diverMove[i];const a=this.map.worldToTileX(this.divers[i].x),h=this.map.worldToTileY(this.divers[i].y);this.tile=this.diverLayer.getTileAt(a,h),this.tile.index==g.START?(this.diverMove[i]=g.SPEED,this.divers[i].play(_.WALK_DOWN,!0)):this.tile.index==g.END&&(this.diverMove[i]=-g.SPEED,this.divers[i].play(_.WALK_UP,!0)),this.trufflesDiverCollision(this.divers[i],i)&&(this.player.getState().handleInput(s.EXPIRED,e,t,this.player),this.addPoints(r.DIVER_COLLISION));for(let e=0;e<this.fruit.length;e++)this.sortLayers(this.divers[i],this.fruit[e]);for(let e=0;e<this.cannonball.length;e++)this.sortLayers(this.divers[i],this.cannonball[e])}let i=this.map.worldToTileX(this.player.getX()),a=this.map.worldToTileY(this.player.getY()-this.player.getVelocityY().y);this.tile=this.collisionLayer.getTileAt(i,a),null==this.tile&&(this.player.push(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}null===(i=this.player.getState().getState())||void 0===i||i.update(e,t,this.player),this.currentScoreText.setPosition(.9*this.screenX,.048*this.screenY),this.currentScoreText.update(),this.currentScoreText.setText(" "+this.levelScore+" "),this.currentScoreText.setDepth(21),this.currentScoreText.setFontSize(40),this.elapsedTimeText.setPosition(.76*this.screenX,.048*this.screenY),this.elapsedTimeText.update(),this.elapsedTimeText.setText(" "+Math.round(.001*this.elapsedLevelTime)+" "),this.elapsedTimeText.setDepth(21),this.elapsedTimeText.setFontSize(40),this.recordTimeText.setPosition(.55*this.screenX,.048*this.screenY),this.recordTimeText.update(),this.bestRecordedTime<h.TIME?this.recordTimeText.setText(" "+this.bestRecordedTime+" "):this.recordTimeText.setText(" --:-- "),this.recordTimeText.setDepth(21),this.recordTimeText.setFontSize(40),this.newTick=!1}setupMap(){this.map=this.make.tilemap({key:"level",tileWidth:this.tileSize,tileHeight:this.tileSize}),this.tileset=this.map.addTilesetImage("truffles_level_1_tileset","tileset"),this.waterLayer=this.map.createLayer("map/water/water_depth_00",this.tileset,0,0),this.waterLayer.setDepth(-21),this.groundLayer=this.map.createLayer("map/ground/ground_depth_00",this.tileset,0,0),this.groundLayer.setDepth(-20),this.ground2Layer=this.map.createLayer("map/shadow/shadow_depth_01",this.tileset,0,0),this.ground2Layer.setDepth(-19),this.house2Layer=this.map.createLayer("map/buildings/foreground/house_depth_01/house_layer_2",this.tileset,0,0),this.house2Layer.setDepth(-19),this.house1Layer=this.map.createLayer("map/buildings/foreground/house_depth_01/house_layer_1",this.tileset,0,0),this.house1Layer.setDepth(-19),this.wall1Layer=this.map.createLayer("map/castle/walls/walls_depth_01",this.tileset,0,0),this.wall1Layer.setDepth(-19),this.wall2Layer=this.map.createLayer("map/castle/walls/walls_depth_03",this.tileset,0,0),this.wall2Layer.setDepth(8),this.churchLayer=this.map.createLayer("map/buildings/foreground/church_depth_01/church_01",this.tileset,0,0),this.churchLayer.setDepth(-9),this.castleLayer=this.map.createLayer("map/castle/castle/castle_depth_01",this.tileset,0,0),this.castleLayer.setDepth(-9),this.miscLayer=this.map.createLayer("map/environment_objects/miscellaneous_depth_01",this.tileset,0,0),this.miscLayer.setDepth(-9),this.wallTop1Layer=this.map.createLayer("map/castle/walls/wall_top_depth_01",this.tileset,0,0),this.wallTop1Layer.setDepth(-9),this.wallTop2Layer=this.map.createLayer("map/castle/walls/wall_top_depth_04",this.tileset,0,0),this.wallTop2Layer.setDepth(9),this.house2RoofLayer=this.map.createLayer("map/buildings/background/house_roof_depth_03/house_roof_layer_2",this.tileset,0,0),this.house2RoofLayer.setDepth(8),this.houseRoofLayer=this.map.createLayer("map/buildings/background/house_roof_depth_03/house_roof_layer_1",this.tileset,0,0),this.houseRoofLayer.setDepth(8),this.towerTop1Layer=this.map.createLayer("map/castle/tower/tower_top_depth_01",this.tileset,0,0),this.towerTop1Layer.setDepth(-9),this.towerTop2Layer=this.map.createLayer("map/castle/tower/tower_top_depth_04",this.tileset,0,0),this.towerTop2Layer.setDepth(9),this.churchRoofLayer=this.map.createLayer("map/buildings/background/church_depth_03/church_roof_03",this.tileset,0,0),this.churchRoofLayer.setDepth(-9),this.castleRoofLayer=this.map.createLayer("map/castle/castle/castle_roof_depth_02",this.tileset,0,0),this.castleRoofLayer.setDepth(7),this.animatedTrees=this.map.createLayer("map/environment_objects/animated/tree_01",this.tileset,0,0),this.animatedTrees.setDepth(-9),this.animatedTrees.setVisible(!1),this.miscTop2Layer=this.map.createLayer("map/environment_objects/tree_top_04",this.tileset,0,0),this.miscTop2Layer.setDepth(9),this.miscTop2Layer.setVisible(!1),this.collisionLayer=this.map.createLayer("map/environment_collision/collide_depth_02",this.tileset,0,0),this.collisionLayer.setDepth(7),this.collisionLayer.setVisible(!1),this.keyLayer=this.map.createLayer("map/environment_objects/animated/key",this.tileset,0,0),this.keyLayer.setDepth(9),this.keyLayer.setVisible(!1),this.fishLayer=this.map.createLayer("map/environment_objects/animated/fish_01",this.tileset,0,0),this.fishLayer.setVisible(!1),this.flowersLayer=this.map.createLayer("map/environment_objects/animated/flower_01",this.tileset,0,0),this.flowersLayer.setDepth(-9),this.flowersLayer.setVisible(!1),this.flagTopLayer=this.map.createLayer("map/environment_objects/animated/flag_top_01",this.tileset,0,0),this.flagTopLayer.setVisible(!1),this.flagLowLayer=this.map.createLayer("map/environment_objects/animated/flag_low_03",this.tileset,0,0),this.flagLowLayer.setVisible(!1),this.animatedAppleTrees=this.map.createLayer("map/environment_objects/animated/tree_apple_01",this.tileset,0,0),this.animatedAppleTrees.setVisible(!1),this.bridgeLayer=this.map.createLayer("map/environment_objects/animated/drawbridge_01",this.tileset,0,0),this.bridgeLayer.setVisible(!1),this.riverLayer=this.map.createLayer("map/water/river_00",this.tileset,0,0),this.riverLayer.setVisible(!1);let e=this.sys.settings.key;e===l.LEVEL_01?(this.candyLayer=this.map.createLayer("map/collectables/candies_level1_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level1",this.tileset,0,0)):e===l.LEVEL_02?(this.candyLayer=this.map.createLayer("map/collectables/candies_level2_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level2",this.tileset,0,0)):e===l.LEVEL_03?(this.candyLayer=this.map.createLayer("map/collectables/candies_level3_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level3",this.tileset,0,0)):e===l.LEVEL_04?(this.candyLayer=this.map.createLayer("map/collectables/candies_level4_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level4",this.tileset,0,0)):(this.candyLayer=this.map.createLayer("map/collectables/candies_level1_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level1",this.tileset,0,0)),this.candyLayer.setDepth(7),this.candyLayer.setVisible(!1),this.diverLayer.setDepth(7),this.diverLayer.setVisible(!1),this.goalLayer=this.map.createLayer("map/goal/goal_depth_02",this.tileset,0,0),this.goalLayer.setDepth(7),this.goalLayer.setVisible(!0)}createSpineObject(e,t,i,s,a,h){let l=this.add.spine(i,s,t,e,!0);return l.scaleX=a,l.scaleY=h,l}initializeAnimationsState(e,t){let i=e.getAnimationList();for(let e=0;e<i.length;e++)t.push(i[e])}changeAnimation(e,t,i){const s=t[i];e.play(s,!0)}trufflesAABB(e){let t=!1;return this.player.getX()-this.tileSize/2<e.x+e.scaleX*e.width&&this.player.getX()+this.tileSize/2>e.x&&this.player.getY()-this.tileSize<e.y+e.scaleY*e.height&&this.player.getY()>e.y&&(t=!0),e.y>this.player.getY()?e.setDepth(1):e.setDepth(-1),t}sortLayers(e,t){Math.abs(e.x-t.x)<e.scaleX*e.width&&Math.abs(e.y-t.y)<e.scaleY*e.height&&(e.y<t.y+t.height*t.scaleY?t.setDepth(e.depth+1):t.setDepth(e.depth-1))}trufflesDiverCollision(e,t){let i=!1;return this.map.worldToTileX(this.player.getX())!=this.map.worldToTileX(e.x)&&this.map.worldToTileX(this.player.getX())!=this.map.worldToTileX(e.x)-1||this.map.worldToTileY(this.player.getY())!=this.map.worldToTileY(e.y)||(i=!0,e.play(_.PUSH,!1),this.player.setPushSpeed(g.PUSH_SPEED),this.time.addEvent({delay:800,callback:this.resetDiverAnimations,callbackScope:this,args:[t]})),e.y>this.player.getY()?e.setDepth(2):e.setDepth(-2),i}resetDiverAnimations(e){this.diverMove[e]>0?this.divers[e].play(_.WALK_DOWN,!0):this.divers[e].play(_.WALK_UP,!0),this.player.setPushSpeed(0)}playChurchBells(e,t,i){let s=Phaser.Math.Between(0,24);12!==s&&6!==s||this.churchBells.play()}fruitAnimations(e,t,i){this.changeAnimation(this.fruit[e],this.fruitAnimationNames,2),this.time.addEvent({delay:1e3,callback:this.fruitDelete,callbackScope:this,args:[e,t,i]})}treeAnimations(e,t,i){let s=Phaser.Math.Between(0,24);for(let e=0;e<this.tree.length;e++)18===s||15===s||12===s||9===s||6===s||3===s?"leaf"!==this.tree[e].getCurrentAnimation().name&&this.tree[e].play("leaf",!0):"idle"!==this.tree[e].getCurrentAnimation().name&&this.tree[e].play("idle",!0);for(let e=0;e<this.apple.length;e++)22===s||20===s||16===s||8===s||4===s||2===s?"leaf"!==this.apple[e].getCurrentAnimation().name&&this.apple[e].play("leaf",!0):"idle"!==this.apple[e].getCurrentAnimation().name&&this.apple[e].play("idle",!0)}fruitDelete(e,t,i){const s=this.map.worldToTileX(this.fruit[e].x),a=this.map.worldToTileY(this.fruit[e].y);this.tile=this.candyLayer.getTileAt(s,a),this.map.removeTile(this.tile),this.fruit[e].removeFromDisplayList(),this.fruitRemaining--}cannonballReset(e){this.cannonball[e].setPosition(this.cannonballPosX[e],this.cannonballPosY[e]=40),this.changeAnimation(this.cannonball[e],this.cannonballAnimationNames,1),this.cannonballMoving[e]=!0}cannonballMove(){for(let e=0;e<this.cannonball.length;e++)this.cannonballMoving[e]&&(this.cannonballPosY[e]+=this.cannonballSpeed,this.cannonball[e].setPosition(this.cannonballPosX[e],this.cannonballPosY[e])),this.cannonballPosY[e]>=655&&(this.time.addEvent({delay:600,callback:this.cannonballReset,callbackScope:this,args:[e]}),this.cannonballMoving[e]&&this.changeAnimation(this.cannonball[e],this.cannonballAnimationNames,2),this.cannonballMoving[e]=!1)}setRecord(e){this.newRecordTime=e,this.hudRecord.play(this.hudRecordAnimationNames[1],!0),this.fetchRecordedTime()}addPoints(e){e>0&&(this.collectablePoints+=e)}fetchRecordedTime(){let e=window.localStorage.getItem("time_"+this.sys.settings.key);null!==e?(this.bestRecordedTime=parseInt(e)||0,0===this.bestRecordedTime&&(this.bestRecordedTime=h.TIME)):this.bestRecordedTime=h.TIME,this.newRecordTime<h.TIME?window.localStorage.setItem("time_"+this.sys.settings.key,this.newRecordTime.toString()):window.localStorage.setItem("time_"+this.sys.settings.key,h.TIME.toString())}fetchRecordedScore(){let e=window.localStorage.getItem("score_"+this.sys.settings.key);this.levelScore=null!==e&&parseInt(e)||0,this.levelScore+=this.collectablePoints,this.collectablePoints=0,window.localStorage.setItem("score_"+this.sys.settings.key,this.levelScore.toString())}gsmUpdate(e,t){this.gameState=a.LEVEL_COMPLETE;let i=this.sys.settings.key;i===l.LEVEL_01?(this.artifact[0].play("pig_fill",!1),this.key[0].play("collected",!0)):i===l.LEVEL_02?(this.artifact[1].play("vase_fill",!1),this.key[1].play("collected",!0)):i===l.LEVEL_03?(this.artifact[2].play("pot_fill",!1),this.key[2].play("collected",!0)):i===l.LEVEL_04?(this.artifact[3].play("alter_fill",!1),this.key[3].play("collected",!0)):l.CREDITS}levelComplete(){this.backingMusic.stop();let e=this.sys.settings.key;e===l.LEVEL_01?this.scene.start(n.ArtiFactOneScene):e===l.LEVEL_02?this.scene.start(n.ArtiFactTwoScene):e===l.LEVEL_03?this.scene.start(n.ArtiFactThreeScene):e===l.LEVEL_04?this.scene.start(n.ArtiFactFourScene):e===l.CREDITS&&this.scene.start(n.CREDITS)}handleDPad(e,t){let i=this.input.activePointer;if(i.isDown){let a=i.x,h=i.y,l=this.dpad.x,n=this.dpad.width,r=this.dpad.y,o=this.dpad.height;this.dpad_down=!1,this.dpad_up=!1,this.dpad_left=!1,this.dpad_right=!1,a<l-n/6&&a>l-S.SCALE*n/2&&(this.dpad_left=!0),a>l+n/6&&a<l+S.SCALE*n/2&&(this.dpad_right=!0),h<r-o/6&&h>r-S.SCALE*o/2&&(this.dpad_up=!0),h>r+o/6&&h<r+S.SCALE*o/2&&(this.dpad_down=!0),this.dpad_down?this.dpad_left?(this.player.getState().handleInput(s.WALK_LEFT,e,t,this.player),this.dpad.play(w.DOWN_LEFT,!0)):this.dpad_right?(this.player.getState().handleInput(s.WALK_RIGHT,e,t,this.player),this.dpad.play(w.DOWN_RIGHT,!0)):(this.player.getState().handleInput(s.WALK_DOWN,e,t,this.player),this.dpad.play(w.DOWN,!0)):this.dpad_up?this.dpad_left?(this.player.getState().handleInput(s.WALK_LEFT,e,t,this.player),this.dpad.play(w.UP_LEFT,!0)):this.dpad_right?(this.player.getState().handleInput(s.WALK_RIGHT,e,t,this.player),this.dpad.play(w.UP_RIGHT,!0)):(this.player.getState().handleInput(s.WALK_UP,e,t,this.player),this.dpad.play(w.UP,!0)):this.dpad_left?(this.player.getState().handleInput(s.WALK_LEFT,e,t,this.player),this.dpad.play(w.LEFT,!0)):this.dpad_right&&(this.player.getState().handleInput(s.WALK_RIGHT,e,t,this.player),this.dpad.play(w.RIGHT,!0))}else this.dpad_down=!1,this.dpad_up=!1,this.dpad_left=!1,this.dpad_right=!1,this.dpad.play(w.IDLE,!0)}}const Xe="truffles",Ce=s.IDLE_NEUTRAL,ze="cannonball",Ve="windmill",Ke="dpad",Fe=["orange","lemon","grape"],Ue="diver",We="bridge",Be="soundbtn",Ge="hudtimer",He="hudrecord",Je=["pig","vase","pot","alter"],Ze=["red","yellow","green","pink"],qe="tree",Qe="apple",$e="fish",et="flowers",tt="flag";class it extends Phaser.Scene{constructor(){super({key:l.LEVEL_03}),this.hudTimerAnimationNames=[],this.hudTimerAnimationIndex=0,this.hudRecordAnimationNames=[],this.hudRecordAnimationIndex=0,this.trufflesAnimationNames=[],this.trufflesAnimationIndex=0,this.cannonball=[],this.cannonballAnimationNames=[],this.cannonballAnimationIndex=0,this.cannonballPosX=[269,525,781],this.cannonballPosY=[60,60,60],this.cannonballSpeed=2,this.cannonballMoving=[!0,!0,!0],this.fruitAnimationNames=[],this.fruitMarked=[],this.artifact=[],this.artifacts=4,this.key=[],this.keyAnimationNames=[],this.tree=[],this.treeAnimationNames=[],this.apple=[],this.appleAnimationNames=[],this.fish=[],this.fishAnimationNames=[],this.flowers=[],this.flowersAnimationNames=[],this.flags=[],this.flagsAnimationNames=[],this.dpadAnimationIndex=0,this.dpadAnimationNames=[],this.dpad_up=!1,this.dpad_down=!1,this.dpad_left=!1,this.dpad_right=!1,this.fruit=[],this.divers=[],this.diverAnimationNames=[],this.diverAnimationIndex=0,this.diverMove=[],this.tileSize=T.SIZE,this.collectablePoints=0,this.levelScore=0,this.newRecordTime=0,this.screenX=0,this.screenY=0,this.startTime=0,this.frameTime=0,this.newTick=!1,this.fps=60,this.delay=1e3/this.fps}preload(e,t){this.load.image("tileset","assets/level/truffles_level_1_tileset.png"),this.load.tilemapTiledJSON("level","assets/level/truffles_level_1.json"),this.load.setPath("assets/spine/"),this.load.spine(Xe,"truffles/truffles_all.json","truffles/truffles_all.atlas"),this.load.spine(Ue,"diver/diver.json","diver/diver.atlas"),this.load.spine(Fe[0],"fruits/orange/orange.json","fruits/orange/orange.atlas"),this.load.spine(Fe[1],"fruits/grape/grape.json","fruits/grape/grape.atlas"),this.load.spine(Fe[2],"fruits/lemon/lemon.json","fruits/lemon/lemon.atlas"),this.load.spine(ze,"cannonball/cannonball.json","cannonball/cannonball.atlas"),this.load.spine(Ve,"windmill/windmill.json","windmill/windmill.atlas"),this.load.spine(Ke,"dpad/DPad_Final_merge.json","dpad/DPad_Final_merge.atlas"),this.load.spine(Be,"sound/sound.json","sound/sound.atlas"),this.load.spine(Ge,"timer/timer.json","timer/timer.atlas"),this.load.spine(We,"drawbridge/drawbridge.json","drawbridge/drawbridge.atlas"),this.load.spine(He,"record/record.json","record/record.atlas"),this.load.spine(Je[0],"collectibles_ui/pig/pig.json","collectibles_ui/pig/pig.atlas"),this.load.spine(Je[1],"collectibles_ui/vase/vase.json","collectibles_ui/vase/vase.atlas"),this.load.spine(Je[2],"collectibles_ui/pot/pot.json","collectibles_ui/pot/pot.atlas"),this.load.spine(Je[3],"collectibles_ui/alter/alter.json","collectibles_ui/alter/alter.atlas"),this.load.spine(Ze[0],"keys/red/red_key.json","keys/red/red_key.atlas"),this.load.spine(Ze[1],"keys/yellow/yellow_key.json","keys/yellow/yellow_key.atlas"),this.load.spine(Ze[2],"keys/green/green_key.json","keys/green/green_key.atlas"),this.load.spine(Ze[3],"keys/pink/pink_key.json","keys/pink/pink_key.atlas"),this.load.spine(qe,"tree/tree.json","tree/tree.atlas"),this.load.spine(Ke,"dpad/DPad_Final_merge.json","dpad/DPad_Final_merge.atlas"),this.load.spine(Qe,"appletree/tree2.json","appletree/tree2.atlas"),this.load.spine($e,"fish/fish.json","fish/fish.atlas"),this.load.spine(et,"flowers/flowers.json","flowers/flowers.atlas"),this.load.spine(tt,"flag/flag.json","flag/flag.atlas")}create(e,t){var i;let{width:s,height:h}=this.sys.game.canvas;this.screenX=s,this.screenY=h,this.vinnette=this.add.image(s/2,h/2,"vinnette"),this.vinnette.setDisplaySize(s,h),this.vinnette.setOrigin(.5,.5),this.vinnette.setDepth(20),this.hud_background=this.add.image(s/2,.04*h,"hud_background"),this.vinnette.setDisplaySize(s,h),this.vinnette.setOrigin(.5,.5),this.vinnette.setDepth(19),this.player=new $(new Phaser.Math.Vector2(100,360)),this.player.setVelocityX(new Phaser.Math.Vector2(2,0)),this.player.setVelocityY(new Phaser.Math.Vector2(0,2)),this.gameState=a.PLAY,this.fetchRecordedScore(),this.fetchRecordedTime(),this.currentScoreText=new A(this),this.currentScoreText.setShadow(3,3),this.currentScoreText.setStroke("#fff",12),this.currentScoreText.setShadow(2,2,"#333333",2,!0,!0),this.currentScoreText.setDepth(21),this.elapsedTimeText=new A(this),this.elapsedTimeText.setShadow(3,3),this.elapsedTimeText.setStroke("#fff",12),this.elapsedTimeText.setShadow(2,2,"#333333",2,!0,!0),this.elapsedTimeText.setDepth(21),this.recordTimeText=new A(this),this.recordTimeText.setShadow(3,3),this.recordTimeText.setStroke("#fff",12),this.recordTimeText.setShadow(2,2,"#333333",2,!0,!0),this.recordTimeText.setDepth(21),this.hudTimer=this.createSpineObject(Ce,Ge,.67*this.screenX,.001*this.screenY,1,1),this.hudTimer.setDepth(21),this.hudTimer.setScale(.75,.75),this.hudTimerAnimationNames=this.hudTimer.getAnimationList(),this.hudTimer.play(this.hudTimerAnimationNames[1],!0),this.hudRecord=this.createSpineObject(Ce,He,.46*this.screenX,.001*this.screenY,1,1),this.hudRecord.setDepth(21),this.hudRecord.setScale(.75,.74),this.hudRecordAnimationNames=this.hudRecord.getAnimationList(),this.hudRecord.play(this.hudRecordAnimationNames[0],!0),this.time.addEvent({delay:500,loop:!0,callback:this.fetchRecordedScore,callbackScope:this}),this.setupMap();let n=this.map.width,r=this.map.height;this.backingMusic=this.sound.add("level_backing_track",{loop:!0}),this.backingMusic.play(),this.churchBells=this.sound.add("church_bells",{volume:.5}),this.time.addEvent({delay:6e3,loop:!0,callback:this.playChurchBells,callbackScope:this}),this.bridgeOpening=this.sound.add("bridge_open"),this.truffles=this.createSpineObject(Ce,Xe,this.player.getX(),this.player.getY(),this.player.getScale(),this.player.getScale()),this.truffles.setDepth(0),this.initializeAnimationsState(this.truffles,this.trufflesAnimationNames);for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.diverLayer.getTileAt(t,e);null!=i&&i.index===g.START&&(this.divers.push(this.createSpineObject(_.WALK_DOWN,Ue,t*this.tileSize,e*this.tileSize+(this.tileSize-1),g.SCALE,g.SCALE)),this.diverMove.push(g.SPEED))}for(let e=0;e<this.divers.length;e++)this.initializeAnimationsState(this.divers[e],this.diverAnimationNames),this.divers[e].setDepth(-1);this.cannonball.push(this.createSpineObject(Ce,ze,this.cannonballPosX[0],this.cannonballPosY[0],1.2,1.2)),this.cannonball.push(this.createSpineObject(Ce,ze,this.cannonballPosX[1],this.cannonballPosY[1],1.2,1.2)),this.cannonball.push(this.createSpineObject(Ce,ze,this.cannonballPosX[2],this.cannonballPosY[2],1.2,1.2));for(let e=0;e<this.cannonball.length;e++)this.initializeAnimationsState(this.cannonball[e],this.cannonballAnimationNames),this.cannonball[e].setDepth(-21);for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.bridgeLayer.getTileAt(t,e);null!=i&&i.index==f.PLACE&&(this.bridge=this.createSpineObject(Ce,We,t*this.tileSize+f.OFFSETX,e*this.tileSize+f.OFFSETY,f.scaleX,f.scaleY))}this.bridge.setDepth(-1),this.bridgeOpen=!1,this.windmill=this.createSpineObject(Ce,Ve,50,0,1,1),this.windmill.setDepth(-1),this.cursors=this.input.keyboard.createCursorKeys(),this.key_w=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.W),this.key_a=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A),this.key_s=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),this.key_d=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.D),this.key_g=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.G),this.game.device.input.touch&&(this.input.addPointer(2),this.dpad=this.createSpineObject(Ce,Ke,this.tileSize*S.X_TILES,this.tileSize*S.Y_TILES,S.SCALE,S.SCALE),this.dpad.setDepth(21));for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.candyLayer.getTileAt(t,e);null!=i&&(i.index===y.ORANGE_TILE?(this.fruit.push(this.createSpineObject(Ce,Fe[0],t*this.tileSize,e*this.tileSize,.7,.7)),this.fruitMarked.push(!1)):i.index===y.LEMON_TILE?(this.fruit.push(this.createSpineObject(Ce,Fe[1],t*this.tileSize,e*this.tileSize,.7,.7)),this.fruitMarked.push(!1)):i.index===y.GRAPE_TILE&&(this.fruit.push(this.createSpineObject(Ce,Fe[2],t*this.tileSize,e*this.tileSize,.7,.7)),this.fruitMarked.push(!1)))}this.fruitRemaining=this.fruit.length,this.artifact[0]=this.createSpineObject(Ce,Je[0],.114*this.screenX,.045*this.screenY,.6,.6),this.artifact[1]=this.createSpineObject(Ce,Je[1],.185*this.screenX,.03*this.screenY,.6,.6),this.artifact[2]=this.createSpineObject(Ce,Je[2],.24*this.screenX,.04*this.screenY,.6,.6),this.artifact[3]=this.createSpineObject(Ce,Je[3],.295*this.screenX,.05*this.screenY,.6,.6),this.artifact[0].setDepth(21),this.artifact[1].setDepth(21),this.artifact[2].setDepth(21),this.artifact[3].setDepth(21);for(let e=0;e<this.fruit.length;e++)this.initializeAnimationsState(this.fruit[e],this.fruitAnimationNames);let o=this.sys.settings.key;for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.keyLayer.getTileAt(t,e);null!=i&&395===i.index&&(o===l.LEVEL_01?(this.key[0]=this.createSpineObject(Ce,Ze[0],t*this.tileSize-80,e*this.tileSize-60,.8,.8),this.key[0].setDepth(10)):o===l.LEVEL_02?(this.key[1]=this.createSpineObject(Ce,Ze[1],t*this.tileSize-80,e*this.tileSize-60,.8,.8),this.key[1].setDepth(10)):o===l.LEVEL_03?(this.key[2]=this.createSpineObject(Ce,Ze[2],t*this.tileSize-80,e*this.tileSize-60,.8,.8),this.key[2].setDepth(10)):o===l.LEVEL_04?(this.key[3]=this.createSpineObject(Ce,Ze[3],t*this.tileSize-80,e*this.tileSize-60,.8,.8),this.key[3].setDepth(10)):l.CREDITS)}for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.animatedTrees.getTileAt(t,e);null!=i&&i.index===m.TILE&&this.tree.push(this.createSpineObject(Ce,qe,t*this.tileSize-33,e*this.tileSize-84,.5,.5))}for(let e=0;e<this.tree.length;e++)this.tree[e].setDepth(-1),this.tree[e].play("idle",!0);for(let e=0;e<this.tree.length;e++)this.treeAnimationNames=this.tree[e].getAnimationList();for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.animatedAppleTrees.getTileAt(t,e);null!=i&&i.index===u.TILE&&this.apple.push(this.createSpineObject(Ce,Qe,t*this.tileSize-61,e*this.tileSize-84,.5,.5))}for(let e=0;e<this.apple.length;e++)this.apple[e].setDepth(-18);this.time.addEvent({delay:6e3,loop:!0,callback:this.treeAnimations,callbackScope:this});for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.fishLayer.getTileAt(t,e);null!=i&&657===i.index&&this.fish.push(this.createSpineObject(Ce,$e,t*this.tileSize,e*this.tileSize-40,1,1))}for(let e=0;e<this.fish.length;e++)this.fish[e].setDepth(19);for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.flowersLayer.getTileAt(t,e);null!=i&&604===i.index&&this.flowers.push(this.createSpineObject(Ce,et,t*this.tileSize-10,e*this.tileSize-15,1,1))}for(let e=0;e<this.flowers.length;e++)this.flowers[e].setDepth(-1);for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.flagTopLayer.getTileAt(t,e);null!=i&&447===i.index&&this.flags.push(this.createSpineObject(Ce,tt,t*this.tileSize+4,e*this.tileSize+2,1,1))}for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.flagLowLayer.getTileAt(t,e);null!=i&&447===i.index&&this.flags.push(this.createSpineObject(Ce,tt,t*this.tileSize,e*this.tileSize,1,1))}for(let e=0;e<this.flags.length;e++)this.flags[e].setDepth(-9);this.soundMuteUnmuteButton=this.createSpineObject(Ce,Be,.022*this.screenX,.014*this.screenY,1,1),this.soundMuteUnmuteButton.setScale(.8,.8),this.soundMuteUnmuteButton.setDepth(21),this.soundMuteUnmuteButton.setInteractive();let d=this.soundMuteUnmuteButton.getAnimationList(),p=(window.localStorage.getItem("soundState"),!0);"false"===window.localStorage.getItem("soundState")&&(this.game.sound.mute=!0,this.soundMuteUnmuteButton.play(d[1],!0)),this.soundMuteUnmuteButton.on("pointerdown",(()=>1==p?(p=!1,this.soundMuteUnmuteButton.play(d[1],!0),window.localStorage.setItem("soundState",p.toString()),void(this.game.sound.mute=!0)):0==p?(p=!0,this.game.sound.mute=!1,this.soundMuteUnmuteButton.play(d[0],!0),void window.localStorage.setItem("soundState",p.toString())):void 0)),this.playerState=new Q(this,this.truffles,0,0),null===(i=this.playerState.getState())||void 0===i||i.enter(0,0,this.player),this.player.setState(this.playerState),o===l.LEVEL_01||(o===l.LEVEL_02?this.artifact[0].play("pig_filled",!1):o===l.LEVEL_03?(this.artifact[0].play("pig_filled",!1),this.artifact[1].play("vase_filled",!1)):o===l.LEVEL_04?(this.artifact[0].play("pig_filled",!0),this.artifact[1].play("vase_filled",!0),this.artifact[2].play("pot_filled",!1)):l.CREDITS)}update(e,t){var i;if(0===this.startTime&&(this.startTime=e),this.frameTime+=t,this.frameTime>this.delay&&(this.frameTime=0,this.newTick=!0),this.gameState===a.PLAY?this.elapsedLevelTime=e-this.startTime:this.gameState===a.LEVEL_COMPLETE&&(this.hudTimer.play(this.hudTimerAnimationNames[1],!0),Math.round(.001*this.elapsedLevelTime)<=this.bestRecordedTime?this.setRecord(Math.round(.001*this.elapsedLevelTime)):this.newRecordTime=this.bestRecordedTime,this.time.addEvent({delay:d.DELAY,loop:!0,callback:this.levelComplete,callbackScope:this})),this.game.device.input.touch&&this.handleDPad(e,t),this.cannonballMove(),this.trufflesAnimationNames.length,Phaser.Input.Keyboard.JustDown(this.cursors.right)||Phaser.Input.Keyboard.JustDown(this.key_d)?this.player.getState().handleInput(s.WALK_RIGHT,e,t,this.player):Phaser.Input.Keyboard.JustDown(this.cursors.left)||Phaser.Input.Keyboard.JustDown(this.key_a)?this.player.getState().handleInput(s.WALK_LEFT,e,t,this.player):Phaser.Input.Keyboard.JustDown(this.cursors.up)||Phaser.Input.Keyboard.JustDown(this.key_w)?this.player.getState().handleInput(s.WALK_UP,e,t,this.player):(Phaser.Input.Keyboard.JustDown(this.cursors.down)||Phaser.Input.Keyboard.JustDown(this.key_s))&&this.player.getState().handleInput(s.WALK_DOWN,e,t,this.player),this.player.getMove()){if(this.cursors.right.isDown||this.key_d.isDown||this.dpad_right){let e=this.map.worldToTileX(this.player.getX()-this.tileSize/2),t=this.map.worldToTileY(this.player.getY());this.tile=this.collisionLayer.getTileAt(e+1,t),null==this.tile&&(this.player.moveRight(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}if(this.cursors.left.isDown||this.key_a.isDown||this.dpad_left){let e=this.map.worldToTileX(this.player.getX()+this.tileSize/2),t=this.map.worldToTileY(this.player.getY());this.tile=this.collisionLayer.getTileAt(e-1,t),null==this.tile&&(this.player.moveLeft(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}if(this.cursors.up.isDown||this.key_w.isDown||this.dpad_up){let e=this.map.worldToTileX(this.player.getX()),t=this.map.worldToTileY(this.player.getY()+this.tileSize/4);this.tile=this.collisionLayer.getTileAt(e,t-1),null==this.tile&&(this.player.moveUp(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}if(this.cursors.down.isDown||this.key_s.isDown||this.dpad_down){let e=this.map.worldToTileX(this.player.getX()),t=this.map.worldToTileY(this.player.getY()+this.player.getVelocityY().y);this.tile=this.collisionLayer.getTileAt(e,t),null==this.tile&&(this.player.moveDown(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}let i=this.map.worldToTileX(this.player.getX()),a=this.map.worldToTileY(this.player.getY());if(this.tile=this.goalLayer.getTileAt(i,a),null!==this.tile&&this.tile.index===p.TILE&&(this.player.getState().handleInput(s.REACHED_GOAL,e,t,this.player),this.addPoints(r.REACHED_GOAL),this.gsmUpdate(e,t)),this.tile=this.riverLayer.getTileAt(i,a),null!==this.tile&&this.tile.index===c.TILE&&this.player.getState().handleInput(s.SPLASH,e,t,this.player),this.cursors.down.isDown||this.cursors.up.isDown||this.cursors.left.isDown||this.cursors.right.isDown||this.key_w.isDown||this.key_a.isDown||this.key_s.isDown||this.key_d.isDown||this.dpad_up||this.dpad_down||this.dpad_left||this.dpad_right){if(this.newTick)for(let i=0;i<this.fruit.length;i++)!this.fruitMarked[i]&&this.trufflesAABB(this.fruit[i])&&(this.changeAnimation(this.fruit[i],this.fruitAnimationNames,1),this.time.addEvent({delay:o.FRUIT,callback:this.fruitAnimations,callbackScope:this,args:[i,e,t]}),this.fruitMarked[i]=!0,0===i?this.addPoints(r.FRUIT_0):1==i?this.addPoints(r.FRUIT_1):2===i&&this.addPoints(r.FRUIT_2),this.player.getState().handleInput(s.EATING,e,t,this.player))}else this.player.getState().handleInput(s.IDLE_NEUTRAL,e,t,this.player)}if(this.fruitRemaining<=0&&!this.bridgeOpen){this.bridge.play(L.TRANSITIONING,!1),this.bridgeOpen=!0,this.bridgeOpening.play();for(let e=0;e<this.map.height;e++)for(let t=0;t<this.map.width;t++)null!=this.bridgeLayer.getTileAt(t,e)&&this.riverLayer.removeTileAt(t,e)}if(this.newTick){for(let i=0;i<this.cannonball.length;i++)this.trufflesAABB(this.cannonball[i])&&(this.player.getState().handleInput(s.EXPIRED,e,t,this.player),this.addPoints(r.CANNON_BALL_COLLISION));for(let i=0;i<this.divers.length;i++){this.divers[i].y+=this.diverMove[i];const a=this.map.worldToTileX(this.divers[i].x),h=this.map.worldToTileY(this.divers[i].y);this.tile=this.diverLayer.getTileAt(a,h),this.tile.index==g.START?(this.diverMove[i]=g.SPEED,this.divers[i].play(_.WALK_DOWN,!0)):this.tile.index==g.END&&(this.diverMove[i]=-g.SPEED,this.divers[i].play(_.WALK_UP,!0)),this.trufflesDiverCollision(this.divers[i],i)&&(this.player.getState().handleInput(s.EXPIRED,e,t,this.player),this.addPoints(r.DIVER_COLLISION));for(let e=0;e<this.fruit.length;e++)this.sortLayers(this.divers[i],this.fruit[e]);for(let e=0;e<this.cannonball.length;e++)this.sortLayers(this.divers[i],this.cannonball[e])}let i=this.map.worldToTileX(this.player.getX()),a=this.map.worldToTileY(this.player.getY()-this.player.getVelocityY().y);this.tile=this.collisionLayer.getTileAt(i,a),null==this.tile&&(this.player.push(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}null===(i=this.player.getState().getState())||void 0===i||i.update(e,t,this.player),this.currentScoreText.setPosition(.9*this.screenX,.048*this.screenY),this.currentScoreText.update(),this.currentScoreText.setText(" "+this.levelScore+" "),this.currentScoreText.setDepth(21),this.currentScoreText.setFontSize(40),this.elapsedTimeText.setPosition(.76*this.screenX,.048*this.screenY),this.elapsedTimeText.update(),this.elapsedTimeText.setText(" "+Math.round(.001*this.elapsedLevelTime)+" "),this.elapsedTimeText.setDepth(21),this.elapsedTimeText.setFontSize(40),this.recordTimeText.setPosition(.55*this.screenX,.048*this.screenY),this.recordTimeText.update(),this.bestRecordedTime<h.TIME?this.recordTimeText.setText(" "+this.bestRecordedTime+" "):this.recordTimeText.setText(" --:-- "),this.recordTimeText.setDepth(21),this.recordTimeText.setFontSize(40),this.newTick=!1}setupMap(){this.map=this.make.tilemap({key:"level",tileWidth:this.tileSize,tileHeight:this.tileSize}),this.tileset=this.map.addTilesetImage("truffles_level_1_tileset","tileset"),this.waterLayer=this.map.createLayer("map/water/water_depth_00",this.tileset,0,0),this.waterLayer.setDepth(-21),this.groundLayer=this.map.createLayer("map/ground/ground_depth_00",this.tileset,0,0),this.groundLayer.setDepth(-20),this.ground2Layer=this.map.createLayer("map/shadow/shadow_depth_01",this.tileset,0,0),this.ground2Layer.setDepth(-19),this.house2Layer=this.map.createLayer("map/buildings/foreground/house_depth_01/house_layer_2",this.tileset,0,0),this.house2Layer.setDepth(-19),this.house1Layer=this.map.createLayer("map/buildings/foreground/house_depth_01/house_layer_1",this.tileset,0,0),this.house1Layer.setDepth(-19),this.wall1Layer=this.map.createLayer("map/castle/walls/walls_depth_01",this.tileset,0,0),this.wall1Layer.setDepth(-19),this.wall2Layer=this.map.createLayer("map/castle/walls/walls_depth_03",this.tileset,0,0),this.wall2Layer.setDepth(8),this.churchLayer=this.map.createLayer("map/buildings/foreground/church_depth_01/church_01",this.tileset,0,0),this.churchLayer.setDepth(-9),this.castleLayer=this.map.createLayer("map/castle/castle/castle_depth_01",this.tileset,0,0),this.castleLayer.setDepth(-9),this.miscLayer=this.map.createLayer("map/environment_objects/miscellaneous_depth_01",this.tileset,0,0),this.miscLayer.setDepth(-9),this.wallTop1Layer=this.map.createLayer("map/castle/walls/wall_top_depth_01",this.tileset,0,0),this.wallTop1Layer.setDepth(-9),this.wallTop2Layer=this.map.createLayer("map/castle/walls/wall_top_depth_04",this.tileset,0,0),this.wallTop2Layer.setDepth(9),this.house2RoofLayer=this.map.createLayer("map/buildings/background/house_roof_depth_03/house_roof_layer_2",this.tileset,0,0),this.house2RoofLayer.setDepth(8),this.houseRoofLayer=this.map.createLayer("map/buildings/background/house_roof_depth_03/house_roof_layer_1",this.tileset,0,0),this.houseRoofLayer.setDepth(8),this.towerTop1Layer=this.map.createLayer("map/castle/tower/tower_top_depth_01",this.tileset,0,0),this.towerTop1Layer.setDepth(-9),this.towerTop2Layer=this.map.createLayer("map/castle/tower/tower_top_depth_04",this.tileset,0,0),this.towerTop2Layer.setDepth(9),this.churchRoofLayer=this.map.createLayer("map/buildings/background/church_depth_03/church_roof_03",this.tileset,0,0),this.churchRoofLayer.setDepth(-9),this.castleRoofLayer=this.map.createLayer("map/castle/castle/castle_roof_depth_02",this.tileset,0,0),this.castleRoofLayer.setDepth(7),this.animatedTrees=this.map.createLayer("map/environment_objects/animated/tree_01",this.tileset,0,0),this.animatedTrees.setDepth(-9),this.animatedTrees.setVisible(!1),this.miscTop2Layer=this.map.createLayer("map/environment_objects/tree_top_04",this.tileset,0,0),this.miscTop2Layer.setDepth(9),this.miscTop2Layer.setVisible(!1),this.collisionLayer=this.map.createLayer("map/environment_collision/collide_depth_02",this.tileset,0,0),this.collisionLayer.setDepth(7),this.collisionLayer.setVisible(!1),this.keyLayer=this.map.createLayer("map/environment_objects/animated/key",this.tileset,0,0),this.keyLayer.setDepth(9),this.keyLayer.setVisible(!1),this.fishLayer=this.map.createLayer("map/environment_objects/animated/fish_01",this.tileset,0,0),this.fishLayer.setVisible(!1),this.flowersLayer=this.map.createLayer("map/environment_objects/animated/flower_01",this.tileset,0,0),this.flowersLayer.setDepth(-9),this.flowersLayer.setVisible(!1),this.flagTopLayer=this.map.createLayer("map/environment_objects/animated/flag_top_01",this.tileset,0,0),this.flagTopLayer.setVisible(!1),this.flagLowLayer=this.map.createLayer("map/environment_objects/animated/flag_low_03",this.tileset,0,0),this.flagLowLayer.setVisible(!1),this.animatedAppleTrees=this.map.createLayer("map/environment_objects/animated/tree_apple_01",this.tileset,0,0),this.animatedAppleTrees.setVisible(!1),this.bridgeLayer=this.map.createLayer("map/environment_objects/animated/drawbridge_01",this.tileset,0,0),this.bridgeLayer.setVisible(!1),this.riverLayer=this.map.createLayer("map/water/river_00",this.tileset,0,0),this.riverLayer.setVisible(!1);let e=this.sys.settings.key;e===l.LEVEL_01?(this.candyLayer=this.map.createLayer("map/collectables/candies_level1_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level1",this.tileset,0,0)):e===l.LEVEL_02?(this.candyLayer=this.map.createLayer("map/collectables/candies_level2_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level2",this.tileset,0,0)):e===l.LEVEL_03?(this.candyLayer=this.map.createLayer("map/collectables/candies_level3_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level3",this.tileset,0,0)):e===l.LEVEL_04?(this.candyLayer=this.map.createLayer("map/collectables/candies_level4_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level4",this.tileset,0,0)):(this.candyLayer=this.map.createLayer("map/collectables/candies_level1_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level1",this.tileset,0,0)),this.candyLayer.setDepth(7),this.candyLayer.setVisible(!1),this.diverLayer.setDepth(7),this.diverLayer.setVisible(!1),this.goalLayer=this.map.createLayer("map/goal/goal_depth_02",this.tileset,0,0),this.goalLayer.setDepth(7),this.goalLayer.setVisible(!0)}createSpineObject(e,t,i,s,a,h){let l=this.add.spine(i,s,t,e,!0);return l.scaleX=a,l.scaleY=h,l}initializeAnimationsState(e,t){let i=e.getAnimationList();for(let e=0;e<i.length;e++)t.push(i[e])}changeAnimation(e,t,i){const s=t[i];e.play(s,!0)}trufflesAABB(e){let t=!1;return this.player.getX()-this.tileSize/2<e.x+e.scaleX*e.width&&this.player.getX()+this.tileSize/2>e.x&&this.player.getY()-this.tileSize<e.y+e.scaleY*e.height&&this.player.getY()>e.y&&(t=!0),e.y>this.player.getY()?e.setDepth(1):e.setDepth(-1),t}sortLayers(e,t){Math.abs(e.x-t.x)<e.scaleX*e.width&&Math.abs(e.y-t.y)<e.scaleY*e.height&&(e.y<t.y+t.height*t.scaleY?t.setDepth(e.depth+1):t.setDepth(e.depth-1))}trufflesDiverCollision(e,t){let i=!1;return this.map.worldToTileX(this.player.getX())!=this.map.worldToTileX(e.x)&&this.map.worldToTileX(this.player.getX())!=this.map.worldToTileX(e.x)-1||this.map.worldToTileY(this.player.getY())!=this.map.worldToTileY(e.y)||(i=!0,e.play(_.PUSH,!1),this.player.setPushSpeed(g.PUSH_SPEED),this.time.addEvent({delay:800,callback:this.resetDiverAnimations,callbackScope:this,args:[t]})),e.y>this.player.getY()?e.setDepth(2):e.setDepth(-2),i}resetDiverAnimations(e){this.diverMove[e]>0?this.divers[e].play(_.WALK_DOWN,!0):this.divers[e].play(_.WALK_UP,!0),this.player.setPushSpeed(0)}playChurchBells(e,t,i){let s=Phaser.Math.Between(0,24);12!==s&&6!==s||this.churchBells.play()}fruitAnimations(e,t,i){this.changeAnimation(this.fruit[e],this.fruitAnimationNames,2),this.time.addEvent({delay:1e3,callback:this.fruitDelete,callbackScope:this,args:[e,t,i]})}treeAnimations(e,t,i){let s=Phaser.Math.Between(0,24);for(let e=0;e<this.tree.length;e++)18===s||15===s||12===s||9===s||6===s||3===s?"leaf"!==this.tree[e].getCurrentAnimation().name&&this.tree[e].play("leaf",!0):"idle"!==this.tree[e].getCurrentAnimation().name&&this.tree[e].play("idle",!0);for(let e=0;e<this.apple.length;e++)22===s||20===s||16===s||8===s||4===s||2===s?"leaf"!==this.apple[e].getCurrentAnimation().name&&this.apple[e].play("leaf",!0):"idle"!==this.apple[e].getCurrentAnimation().name&&this.apple[e].play("idle",!0)}fruitDelete(e,t,i){const s=this.map.worldToTileX(this.fruit[e].x),a=this.map.worldToTileY(this.fruit[e].y);this.tile=this.candyLayer.getTileAt(s,a),this.map.removeTile(this.tile),this.fruit[e].removeFromDisplayList(),this.fruitRemaining--}cannonballReset(e){this.cannonball[e].setPosition(this.cannonballPosX[e],this.cannonballPosY[e]=40),this.changeAnimation(this.cannonball[e],this.cannonballAnimationNames,1),this.cannonballMoving[e]=!0}cannonballMove(){for(let e=0;e<this.cannonball.length;e++)this.cannonballMoving[e]&&(this.cannonballPosY[e]+=this.cannonballSpeed,this.cannonball[e].setPosition(this.cannonballPosX[e],this.cannonballPosY[e])),this.cannonballPosY[e]>=655&&(this.time.addEvent({delay:600,callback:this.cannonballReset,callbackScope:this,args:[e]}),this.cannonballMoving[e]&&this.changeAnimation(this.cannonball[e],this.cannonballAnimationNames,2),this.cannonballMoving[e]=!1)}setRecord(e){this.newRecordTime=e,this.hudRecord.play(this.hudRecordAnimationNames[1],!0),this.fetchRecordedTime()}addPoints(e){e>0&&(this.collectablePoints+=e)}fetchRecordedTime(){let e=window.localStorage.getItem("time_"+this.sys.settings.key);null!==e?(this.bestRecordedTime=parseInt(e)||0,0===this.bestRecordedTime&&(this.bestRecordedTime=h.TIME)):this.bestRecordedTime=h.TIME,this.newRecordTime<h.TIME?window.localStorage.setItem("time_"+this.sys.settings.key,this.newRecordTime.toString()):window.localStorage.setItem("time_"+this.sys.settings.key,h.TIME.toString())}fetchRecordedScore(){let e=window.localStorage.getItem("score_"+this.sys.settings.key);this.levelScore=null!==e&&parseInt(e)||0,this.levelScore+=this.collectablePoints,this.collectablePoints=0,window.localStorage.setItem("score_"+this.sys.settings.key,this.levelScore.toString())}gsmUpdate(e,t){this.gameState=a.LEVEL_COMPLETE;let i=this.sys.settings.key;i===l.LEVEL_01?(this.artifact[0].play("pig_fill",!1),this.key[0].play("collected",!0)):i===l.LEVEL_02?(this.artifact[1].play("vase_fill",!1),this.key[1].play("collected",!0)):i===l.LEVEL_03?(this.artifact[2].play("pot_fill",!1),this.key[2].play("collected",!0)):i===l.LEVEL_04?(this.artifact[3].play("alter_fill",!1),this.key[3].play("collected",!0)):l.CREDITS}levelComplete(){this.backingMusic.stop();let e=this.sys.settings.key;e===l.LEVEL_01?this.scene.start(n.ArtiFactOneScene):e===l.LEVEL_02?this.scene.start(n.ArtiFactTwoScene):e===l.LEVEL_03?this.scene.start(n.ArtiFactThreeScene):e===l.LEVEL_04?this.scene.start(n.ArtiFactFourScene):e===l.CREDITS&&this.scene.start(n.CREDITS)}handleDPad(e,t){let i=this.input.activePointer;if(i.isDown){let a=i.x,h=i.y,l=this.dpad.x,n=this.dpad.width,r=this.dpad.y,o=this.dpad.height;this.dpad_down=!1,this.dpad_up=!1,this.dpad_left=!1,this.dpad_right=!1,a<l-n/6&&a>l-S.SCALE*n/2&&(this.dpad_left=!0),a>l+n/6&&a<l+S.SCALE*n/2&&(this.dpad_right=!0),h<r-o/6&&h>r-S.SCALE*o/2&&(this.dpad_up=!0),h>r+o/6&&h<r+S.SCALE*o/2&&(this.dpad_down=!0),this.dpad_down?this.dpad_left?(this.player.getState().handleInput(s.WALK_LEFT,e,t,this.player),this.dpad.play(w.DOWN_LEFT,!0)):this.dpad_right?(this.player.getState().handleInput(s.WALK_RIGHT,e,t,this.player),this.dpad.play(w.DOWN_RIGHT,!0)):(this.player.getState().handleInput(s.WALK_DOWN,e,t,this.player),this.dpad.play(w.DOWN,!0)):this.dpad_up?this.dpad_left?(this.player.getState().handleInput(s.WALK_LEFT,e,t,this.player),this.dpad.play(w.UP_LEFT,!0)):this.dpad_right?(this.player.getState().handleInput(s.WALK_RIGHT,e,t,this.player),this.dpad.play(w.UP_RIGHT,!0)):(this.player.getState().handleInput(s.WALK_UP,e,t,this.player),this.dpad.play(w.UP,!0)):this.dpad_left?(this.player.getState().handleInput(s.WALK_LEFT,e,t,this.player),this.dpad.play(w.LEFT,!0)):this.dpad_right&&(this.player.getState().handleInput(s.WALK_RIGHT,e,t,this.player),this.dpad.play(w.RIGHT,!0))}else this.dpad_down=!1,this.dpad_up=!1,this.dpad_left=!1,this.dpad_right=!1,this.dpad.play(w.IDLE,!0)}}const st="truffles",at=s.IDLE_NEUTRAL,ht="cannonball",lt="windmill",nt="dpad",rt=["orange","lemon","grape"],ot="diver",dt="bridge",pt="soundbtn",ct="hudtimer",mt="hudrecord",ut=["pig","vase","pot","alter"],yt=["red","yellow","green","pink"],gt="tree",_t="apple",ft="fish",Lt="flowers",Tt="flag";class St extends Phaser.Scene{constructor(){super({key:l.LEVEL_04}),this.hudTimerAnimationNames=[],this.hudTimerAnimationIndex=0,this.hudRecordAnimationNames=[],this.hudRecordAnimationIndex=0,this.trufflesAnimationNames=[],this.trufflesAnimationIndex=0,this.cannonball=[],this.cannonballAnimationNames=[],this.cannonballAnimationIndex=0,this.cannonballPosX=[269,525,781],this.cannonballPosY=[60,60,60],this.cannonballSpeed=2,this.cannonballMoving=[!0,!0,!0],this.fruitAnimationNames=[],this.fruitMarked=[],this.artifact=[],this.artifacts=4,this.key=[],this.keyAnimationNames=[],this.tree=[],this.treeAnimationNames=[],this.apple=[],this.appleAnimationNames=[],this.fish=[],this.fishAnimationNames=[],this.flowers=[],this.flowersAnimationNames=[],this.flags=[],this.flagsAnimationNames=[],this.dpadAnimationIndex=0,this.dpadAnimationNames=[],this.dpad_up=!1,this.dpad_down=!1,this.dpad_left=!1,this.dpad_right=!1,this.fruit=[],this.divers=[],this.diverAnimationNames=[],this.diverAnimationIndex=0,this.diverMove=[],this.tileSize=T.SIZE,this.collectablePoints=0,this.levelScore=0,this.newRecordTime=0,this.screenX=0,this.screenY=0,this.startTime=0,this.frameTime=0,this.newTick=!1,this.fps=60,this.delay=1e3/this.fps}preload(e,t){this.load.image("tileset","assets/level/truffles_level_1_tileset.png"),this.load.tilemapTiledJSON("level","assets/level/truffles_level_1.json"),this.load.setPath("assets/spine/"),this.load.spine(st,"truffles/truffles_all.json","truffles/truffles_all.atlas"),this.load.spine(ot,"diver/diver.json","diver/diver.atlas"),this.load.spine(rt[0],"fruits/orange/orange.json","fruits/orange/orange.atlas"),this.load.spine(rt[1],"fruits/grape/grape.json","fruits/grape/grape.atlas"),this.load.spine(rt[2],"fruits/lemon/lemon.json","fruits/lemon/lemon.atlas"),this.load.spine(ht,"cannonball/cannonball.json","cannonball/cannonball.atlas"),this.load.spine(lt,"windmill/windmill.json","windmill/windmill.atlas"),this.load.spine(nt,"dpad/DPad_Final_merge.json","dpad/DPad_Final_merge.atlas"),this.load.spine(pt,"sound/sound.json","sound/sound.atlas"),this.load.spine(ct,"timer/timer.json","timer/timer.atlas"),this.load.spine(dt,"drawbridge/drawbridge.json","drawbridge/drawbridge.atlas"),this.load.spine(mt,"record/record.json","record/record.atlas"),this.load.spine(ut[0],"collectibles_ui/pig/pig.json","collectibles_ui/pig/pig.atlas"),this.load.spine(ut[1],"collectibles_ui/vase/vase.json","collectibles_ui/vase/vase.atlas"),this.load.spine(ut[2],"collectibles_ui/pot/pot.json","collectibles_ui/pot/pot.atlas"),this.load.spine(ut[3],"collectibles_ui/alter/alter.json","collectibles_ui/alter/alter.atlas"),this.load.spine(yt[0],"keys/red/red_key.json","keys/red/red_key.atlas"),this.load.spine(yt[1],"keys/yellow/yellow_key.json","keys/yellow/yellow_key.atlas"),this.load.spine(yt[2],"keys/green/green_key.json","keys/green/green_key.atlas"),this.load.spine(yt[3],"keys/pink/pink_key.json","keys/pink/pink_key.atlas"),this.load.spine(gt,"tree/tree.json","tree/tree.atlas"),this.load.spine(nt,"dpad/DPad_Final_merge.json","dpad/DPad_Final_merge.atlas"),this.load.spine(_t,"appletree/tree2.json","appletree/tree2.atlas"),this.load.spine(ft,"fish/fish.json","fish/fish.atlas"),this.load.spine(Lt,"flowers/flowers.json","flowers/flowers.atlas"),this.load.spine(Tt,"flag/flag.json","flag/flag.atlas")}create(e,t){var i;let{width:s,height:h}=this.sys.game.canvas;this.screenX=s,this.screenY=h,this.vinnette=this.add.image(s/2,h/2,"vinnette"),this.vinnette.setDisplaySize(s,h),this.vinnette.setOrigin(.5,.5),this.vinnette.setDepth(20),this.hud_background=this.add.image(s/2,.04*h,"hud_background"),this.vinnette.setDisplaySize(s,h),this.vinnette.setOrigin(.5,.5),this.vinnette.setDepth(19),this.player=new $(new Phaser.Math.Vector2(100,360)),this.player.setVelocityX(new Phaser.Math.Vector2(2,0)),this.player.setVelocityY(new Phaser.Math.Vector2(0,2)),this.gameState=a.PLAY,this.fetchRecordedScore(),this.fetchRecordedTime(),this.currentScoreText=new A(this),this.currentScoreText.setShadow(3,3),this.currentScoreText.setStroke("#fff",12),this.currentScoreText.setShadow(2,2,"#333333",2,!0,!0),this.currentScoreText.setDepth(21),this.elapsedTimeText=new A(this),this.elapsedTimeText.setShadow(3,3),this.elapsedTimeText.setStroke("#fff",12),this.elapsedTimeText.setShadow(2,2,"#333333",2,!0,!0),this.elapsedTimeText.setDepth(21),this.recordTimeText=new A(this),this.recordTimeText.setShadow(3,3),this.recordTimeText.setStroke("#fff",12),this.recordTimeText.setShadow(2,2,"#333333",2,!0,!0),this.recordTimeText.setDepth(21),this.hudTimer=this.createSpineObject(at,ct,.67*this.screenX,.001*this.screenY,1,1),this.hudTimer.setDepth(21),this.hudTimer.setScale(.75,.75),this.hudTimerAnimationNames=this.hudTimer.getAnimationList(),this.hudTimer.play(this.hudTimerAnimationNames[1],!0),this.hudRecord=this.createSpineObject(at,mt,.46*this.screenX,.001*this.screenY,1,1),this.hudRecord.setDepth(21),this.hudRecord.setScale(.75,.74),this.hudRecordAnimationNames=this.hudRecord.getAnimationList(),this.hudRecord.play(this.hudRecordAnimationNames[0],!0),this.time.addEvent({delay:500,loop:!0,callback:this.fetchRecordedScore,callbackScope:this}),this.setupMap();let n=this.map.width,r=this.map.height;this.backingMusic=this.sound.add("level_backing_track",{loop:!0}),this.backingMusic.play(),this.churchBells=this.sound.add("church_bells",{volume:.5}),this.time.addEvent({delay:6e3,loop:!0,callback:this.playChurchBells,callbackScope:this}),this.bridgeOpening=this.sound.add("bridge_open"),this.truffles=this.createSpineObject(at,st,this.player.getX(),this.player.getY(),this.player.getScale(),this.player.getScale()),this.truffles.setDepth(0),this.initializeAnimationsState(this.truffles,this.trufflesAnimationNames);for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.diverLayer.getTileAt(t,e);null!=i&&i.index===g.START&&(this.divers.push(this.createSpineObject(_.WALK_DOWN,ot,t*this.tileSize,e*this.tileSize+(this.tileSize-1),g.SCALE,g.SCALE)),this.diverMove.push(g.SPEED))}for(let e=0;e<this.divers.length;e++)this.initializeAnimationsState(this.divers[e],this.diverAnimationNames),this.divers[e].setDepth(-1);this.cannonball.push(this.createSpineObject(at,ht,this.cannonballPosX[0],this.cannonballPosY[0],1.2,1.2)),this.cannonball.push(this.createSpineObject(at,ht,this.cannonballPosX[1],this.cannonballPosY[1],1.2,1.2)),this.cannonball.push(this.createSpineObject(at,ht,this.cannonballPosX[2],this.cannonballPosY[2],1.2,1.2));for(let e=0;e<this.cannonball.length;e++)this.initializeAnimationsState(this.cannonball[e],this.cannonballAnimationNames),this.cannonball[e].setDepth(-21);for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.bridgeLayer.getTileAt(t,e);null!=i&&i.index==f.PLACE&&(this.bridge=this.createSpineObject(at,dt,t*this.tileSize+f.OFFSETX,e*this.tileSize+f.OFFSETY,f.scaleX,f.scaleY))}this.bridge.setDepth(-1),this.bridgeOpen=!1,this.windmill=this.createSpineObject(at,lt,50,0,1,1),this.windmill.setDepth(-1),this.cursors=this.input.keyboard.createCursorKeys(),this.key_w=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.W),this.key_a=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A),this.key_s=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.S),this.key_d=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.D),this.key_g=this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.G),this.game.device.input.touch&&(this.input.addPointer(2),this.dpad=this.createSpineObject(at,nt,this.tileSize*S.X_TILES,this.tileSize*S.Y_TILES,S.SCALE,S.SCALE),this.dpad.setDepth(21));for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.candyLayer.getTileAt(t,e);null!=i&&(i.index===y.ORANGE_TILE?(this.fruit.push(this.createSpineObject(at,rt[0],t*this.tileSize,e*this.tileSize,.7,.7)),this.fruitMarked.push(!1)):i.index===y.LEMON_TILE?(this.fruit.push(this.createSpineObject(at,rt[1],t*this.tileSize,e*this.tileSize,.7,.7)),this.fruitMarked.push(!1)):i.index===y.GRAPE_TILE&&(this.fruit.push(this.createSpineObject(at,rt[2],t*this.tileSize,e*this.tileSize,.7,.7)),this.fruitMarked.push(!1)))}this.fruitRemaining=this.fruit.length,this.artifact[0]=this.createSpineObject(at,ut[0],.114*this.screenX,.045*this.screenY,.6,.6),this.artifact[1]=this.createSpineObject(at,ut[1],.185*this.screenX,.03*this.screenY,.6,.6),this.artifact[2]=this.createSpineObject(at,ut[2],.24*this.screenX,.04*this.screenY,.6,.6),this.artifact[3]=this.createSpineObject(at,ut[3],.295*this.screenX,.05*this.screenY,.6,.6),this.artifact[0].setDepth(21),this.artifact[1].setDepth(21),this.artifact[2].setDepth(21),this.artifact[3].setDepth(21);for(let e=0;e<this.fruit.length;e++)this.initializeAnimationsState(this.fruit[e],this.fruitAnimationNames);let o=this.sys.settings.key;for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.keyLayer.getTileAt(t,e);null!=i&&395===i.index&&(o===l.LEVEL_01?(this.key[0]=this.createSpineObject(at,yt[0],t*this.tileSize-80,e*this.tileSize-60,.8,.8),this.key[0].setDepth(10)):o===l.LEVEL_02?(this.key[1]=this.createSpineObject(at,yt[1],t*this.tileSize-80,e*this.tileSize-60,.8,.8),this.key[1].setDepth(10)):o===l.LEVEL_03?(this.key[2]=this.createSpineObject(at,yt[2],t*this.tileSize-80,e*this.tileSize-60,.8,.8),this.key[2].setDepth(10)):o===l.LEVEL_04?(this.key[3]=this.createSpineObject(at,yt[3],t*this.tileSize-80,e*this.tileSize-60,.8,.8),this.key[3].setDepth(10)):l.CREDITS)}for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.animatedTrees.getTileAt(t,e);null!=i&&i.index===m.TILE&&this.tree.push(this.createSpineObject(at,gt,t*this.tileSize-33,e*this.tileSize-84,.5,.5))}for(let e=0;e<this.tree.length;e++)this.tree[e].setDepth(-1),this.tree[e].play("idle",!0);for(let e=0;e<this.tree.length;e++)this.treeAnimationNames=this.tree[e].getAnimationList();for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.animatedAppleTrees.getTileAt(t,e);null!=i&&i.index===u.TILE&&this.apple.push(this.createSpineObject(at,_t,t*this.tileSize-61,e*this.tileSize-84,.5,.5))}for(let e=0;e<this.apple.length;e++)this.apple[e].setDepth(-18);this.time.addEvent({delay:6e3,loop:!0,callback:this.treeAnimations,callbackScope:this});for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.fishLayer.getTileAt(t,e);null!=i&&657===i.index&&this.fish.push(this.createSpineObject(at,ft,t*this.tileSize,e*this.tileSize-40,1,1))}for(let e=0;e<this.fish.length;e++)this.fish[e].setDepth(19);for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.flowersLayer.getTileAt(t,e);null!=i&&604===i.index&&this.flowers.push(this.createSpineObject(at,Lt,t*this.tileSize-10,e*this.tileSize-15,1,1))}for(let e=0;e<this.flowers.length;e++)this.flowers[e].setDepth(-1);for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.flagTopLayer.getTileAt(t,e);null!=i&&447===i.index&&this.flags.push(this.createSpineObject(at,Tt,t*this.tileSize+4,e*this.tileSize+2,1,1))}for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=this.flagLowLayer.getTileAt(t,e);null!=i&&447===i.index&&this.flags.push(this.createSpineObject(at,Tt,t*this.tileSize,e*this.tileSize,1,1))}for(let e=0;e<this.flags.length;e++)this.flags[e].setDepth(-9);this.soundMuteUnmuteButton=this.createSpineObject(at,pt,.022*this.screenX,.014*this.screenY,1,1),this.soundMuteUnmuteButton.setScale(.8,.8),this.soundMuteUnmuteButton.setDepth(21),this.soundMuteUnmuteButton.setInteractive();let d=this.soundMuteUnmuteButton.getAnimationList(),p=(window.localStorage.getItem("soundState"),!0);"false"===window.localStorage.getItem("soundState")&&(this.game.sound.mute=!0,this.soundMuteUnmuteButton.play(d[1],!0)),this.soundMuteUnmuteButton.on("pointerdown",(()=>1==p?(p=!1,this.soundMuteUnmuteButton.play(d[1],!0),window.localStorage.setItem("soundState",p.toString()),void(this.game.sound.mute=!0)):0==p?(p=!0,this.game.sound.mute=!1,this.soundMuteUnmuteButton.play(d[0],!0),void window.localStorage.setItem("soundState",p.toString())):void 0)),this.playerState=new Q(this,this.truffles,0,0),null===(i=this.playerState.getState())||void 0===i||i.enter(0,0,this.player),this.player.setState(this.playerState),o===l.LEVEL_01||(o===l.LEVEL_02?this.artifact[0].play("pig_filled",!1):o===l.LEVEL_03?(this.artifact[0].play("pig_filled",!1),this.artifact[1].play("vase_filled",!1)):o===l.LEVEL_04?(this.artifact[0].play("pig_filled",!0),this.artifact[1].play("vase_filled",!0),this.artifact[2].play("pot_filled",!1)):l.CREDITS)}update(e,t){var i;if(0===this.startTime&&(this.startTime=e),this.frameTime+=t,this.frameTime>this.delay&&(this.frameTime=0,this.newTick=!0),this.gameState===a.PLAY?this.elapsedLevelTime=e-this.startTime:this.gameState===a.LEVEL_COMPLETE&&(this.hudTimer.play(this.hudTimerAnimationNames[1],!0),Math.round(.001*this.elapsedLevelTime)<=this.bestRecordedTime?this.setRecord(Math.round(.001*this.elapsedLevelTime)):this.newRecordTime=this.bestRecordedTime,this.time.addEvent({delay:d.DELAY,loop:!0,callback:this.levelComplete,callbackScope:this})),this.game.device.input.touch&&this.handleDPad(e,t),this.cannonballMove(),this.trufflesAnimationNames.length,Phaser.Input.Keyboard.JustDown(this.cursors.right)||Phaser.Input.Keyboard.JustDown(this.key_d)?this.player.getState().handleInput(s.WALK_RIGHT,e,t,this.player):Phaser.Input.Keyboard.JustDown(this.cursors.left)||Phaser.Input.Keyboard.JustDown(this.key_a)?this.player.getState().handleInput(s.WALK_LEFT,e,t,this.player):Phaser.Input.Keyboard.JustDown(this.cursors.up)||Phaser.Input.Keyboard.JustDown(this.key_w)?this.player.getState().handleInput(s.WALK_UP,e,t,this.player):(Phaser.Input.Keyboard.JustDown(this.cursors.down)||Phaser.Input.Keyboard.JustDown(this.key_s))&&this.player.getState().handleInput(s.WALK_DOWN,e,t,this.player),this.player.getMove()){if(this.cursors.right.isDown||this.key_d.isDown||this.dpad_right){let e=this.map.worldToTileX(this.player.getX()-this.tileSize/2),t=this.map.worldToTileY(this.player.getY());this.tile=this.collisionLayer.getTileAt(e+1,t),null==this.tile&&(this.player.moveRight(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}if(this.cursors.left.isDown||this.key_a.isDown||this.dpad_left){let e=this.map.worldToTileX(this.player.getX()+this.tileSize/2),t=this.map.worldToTileY(this.player.getY());this.tile=this.collisionLayer.getTileAt(e-1,t),null==this.tile&&(this.player.moveLeft(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}if(this.cursors.up.isDown||this.key_w.isDown||this.dpad_up){let e=this.map.worldToTileX(this.player.getX()),t=this.map.worldToTileY(this.player.getY()+this.tileSize/4);this.tile=this.collisionLayer.getTileAt(e,t-1),null==this.tile&&(this.player.moveUp(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}if(this.cursors.down.isDown||this.key_s.isDown||this.dpad_down){let e=this.map.worldToTileX(this.player.getX()),t=this.map.worldToTileY(this.player.getY()+this.player.getVelocityY().y);this.tile=this.collisionLayer.getTileAt(e,t),null==this.tile&&(this.player.moveDown(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}let i=this.map.worldToTileX(this.player.getX()),a=this.map.worldToTileY(this.player.getY());if(this.tile=this.goalLayer.getTileAt(i,a),null!==this.tile&&this.tile.index===p.TILE&&(this.player.getState().handleInput(s.REACHED_GOAL,e,t,this.player),this.addPoints(r.REACHED_GOAL),this.gsmUpdate(e,t)),this.tile=this.riverLayer.getTileAt(i,a),null!==this.tile&&this.tile.index===c.TILE&&this.player.getState().handleInput(s.SPLASH,e,t,this.player),this.cursors.down.isDown||this.cursors.up.isDown||this.cursors.left.isDown||this.cursors.right.isDown||this.key_w.isDown||this.key_a.isDown||this.key_s.isDown||this.key_d.isDown||this.dpad_up||this.dpad_down||this.dpad_left||this.dpad_right){if(this.newTick)for(let i=0;i<this.fruit.length;i++)!this.fruitMarked[i]&&this.trufflesAABB(this.fruit[i])&&(this.changeAnimation(this.fruit[i],this.fruitAnimationNames,1),this.time.addEvent({delay:o.FRUIT,callback:this.fruitAnimations,callbackScope:this,args:[i,e,t]}),this.fruitMarked[i]=!0,0===i?this.addPoints(r.FRUIT_0):1==i?this.addPoints(r.FRUIT_1):2===i&&this.addPoints(r.FRUIT_2),this.player.getState().handleInput(s.EATING,e,t,this.player))}else this.player.getState().handleInput(s.IDLE_NEUTRAL,e,t,this.player)}if(this.fruitRemaining<=0&&!this.bridgeOpen){this.bridge.play(L.TRANSITIONING,!1),this.bridgeOpen=!0,this.bridgeOpening.play();for(let e=0;e<this.map.height;e++)for(let t=0;t<this.map.width;t++)null!=this.bridgeLayer.getTileAt(t,e)&&this.riverLayer.removeTileAt(t,e)}if(this.newTick){for(let i=0;i<this.cannonball.length;i++)this.trufflesAABB(this.cannonball[i])&&(this.player.getState().handleInput(s.EXPIRED,e,t,this.player),this.addPoints(r.CANNON_BALL_COLLISION));for(let i=0;i<this.divers.length;i++){this.divers[i].y+=this.diverMove[i];const a=this.map.worldToTileX(this.divers[i].x),h=this.map.worldToTileY(this.divers[i].y);this.tile=this.diverLayer.getTileAt(a,h),this.tile.index==g.START?(this.diverMove[i]=g.SPEED,this.divers[i].play(_.WALK_DOWN,!0)):this.tile.index==g.END&&(this.diverMove[i]=-g.SPEED,this.divers[i].play(_.WALK_UP,!0)),this.trufflesDiverCollision(this.divers[i],i)&&(this.player.getState().handleInput(s.EXPIRED,e,t,this.player),this.addPoints(r.DIVER_COLLISION));for(let e=0;e<this.fruit.length;e++)this.sortLayers(this.divers[i],this.fruit[e]);for(let e=0;e<this.cannonball.length;e++)this.sortLayers(this.divers[i],this.cannonball[e])}let i=this.map.worldToTileX(this.player.getX()),a=this.map.worldToTileY(this.player.getY()-this.player.getVelocityY().y);this.tile=this.collisionLayer.getTileAt(i,a),null==this.tile&&(this.player.push(),this.truffles.setPosition(this.player.getX(),this.player.getY()))}null===(i=this.player.getState().getState())||void 0===i||i.update(e,t,this.player),this.currentScoreText.setPosition(.9*this.screenX,.048*this.screenY),this.currentScoreText.update(),this.currentScoreText.setText(" "+this.levelScore+" "),this.currentScoreText.setDepth(21),this.currentScoreText.setFontSize(40),this.elapsedTimeText.setPosition(.76*this.screenX,.048*this.screenY),this.elapsedTimeText.update(),this.elapsedTimeText.setText(" "+Math.round(.001*this.elapsedLevelTime)+" "),this.elapsedTimeText.setDepth(21),this.elapsedTimeText.setFontSize(40),this.recordTimeText.setPosition(.55*this.screenX,.048*this.screenY),this.recordTimeText.update(),this.bestRecordedTime<h.TIME?this.recordTimeText.setText(" "+this.bestRecordedTime+" "):this.recordTimeText.setText(" --:-- "),this.recordTimeText.setDepth(21),this.recordTimeText.setFontSize(40),this.newTick=!1}setupMap(){this.map=this.make.tilemap({key:"level",tileWidth:this.tileSize,tileHeight:this.tileSize}),this.tileset=this.map.addTilesetImage("truffles_level_1_tileset","tileset"),this.waterLayer=this.map.createLayer("map/water/water_depth_00",this.tileset,0,0),this.waterLayer.setDepth(-21),this.groundLayer=this.map.createLayer("map/ground/ground_depth_00",this.tileset,0,0),this.groundLayer.setDepth(-20),this.ground2Layer=this.map.createLayer("map/shadow/shadow_depth_01",this.tileset,0,0),this.ground2Layer.setDepth(-19),this.house2Layer=this.map.createLayer("map/buildings/foreground/house_depth_01/house_layer_2",this.tileset,0,0),this.house2Layer.setDepth(-19),this.house1Layer=this.map.createLayer("map/buildings/foreground/house_depth_01/house_layer_1",this.tileset,0,0),this.house1Layer.setDepth(-19),this.wall1Layer=this.map.createLayer("map/castle/walls/walls_depth_01",this.tileset,0,0),this.wall1Layer.setDepth(-19),this.wall2Layer=this.map.createLayer("map/castle/walls/walls_depth_03",this.tileset,0,0),this.wall2Layer.setDepth(8),this.churchLayer=this.map.createLayer("map/buildings/foreground/church_depth_01/church_01",this.tileset,0,0),this.churchLayer.setDepth(-9),this.castleLayer=this.map.createLayer("map/castle/castle/castle_depth_01",this.tileset,0,0),this.castleLayer.setDepth(-9),this.miscLayer=this.map.createLayer("map/environment_objects/miscellaneous_depth_01",this.tileset,0,0),this.miscLayer.setDepth(-9),this.wallTop1Layer=this.map.createLayer("map/castle/walls/wall_top_depth_01",this.tileset,0,0),this.wallTop1Layer.setDepth(-9),this.wallTop2Layer=this.map.createLayer("map/castle/walls/wall_top_depth_04",this.tileset,0,0),this.wallTop2Layer.setDepth(9),this.house2RoofLayer=this.map.createLayer("map/buildings/background/house_roof_depth_03/house_roof_layer_2",this.tileset,0,0),this.house2RoofLayer.setDepth(8),this.houseRoofLayer=this.map.createLayer("map/buildings/background/house_roof_depth_03/house_roof_layer_1",this.tileset,0,0),this.houseRoofLayer.setDepth(8),this.towerTop1Layer=this.map.createLayer("map/castle/tower/tower_top_depth_01",this.tileset,0,0),this.towerTop1Layer.setDepth(-9),this.towerTop2Layer=this.map.createLayer("map/castle/tower/tower_top_depth_04",this.tileset,0,0),this.towerTop2Layer.setDepth(9),this.churchRoofLayer=this.map.createLayer("map/buildings/background/church_depth_03/church_roof_03",this.tileset,0,0),this.churchRoofLayer.setDepth(-9),this.castleRoofLayer=this.map.createLayer("map/castle/castle/castle_roof_depth_02",this.tileset,0,0),this.castleRoofLayer.setDepth(7),this.animatedTrees=this.map.createLayer("map/environment_objects/animated/tree_01",this.tileset,0,0),this.animatedTrees.setDepth(-9),this.animatedTrees.setVisible(!1),this.miscTop2Layer=this.map.createLayer("map/environment_objects/tree_top_04",this.tileset,0,0),this.miscTop2Layer.setDepth(9),this.miscTop2Layer.setVisible(!1),this.collisionLayer=this.map.createLayer("map/environment_collision/collide_depth_02",this.tileset,0,0),this.collisionLayer.setDepth(7),this.collisionLayer.setVisible(!1),this.keyLayer=this.map.createLayer("map/environment_objects/animated/key",this.tileset,0,0),this.keyLayer.setDepth(9),this.keyLayer.setVisible(!1),this.fishLayer=this.map.createLayer("map/environment_objects/animated/fish_01",this.tileset,0,0),this.fishLayer.setVisible(!1),this.flowersLayer=this.map.createLayer("map/environment_objects/animated/flower_01",this.tileset,0,0),this.flowersLayer.setDepth(-9),this.flowersLayer.setVisible(!1),this.flagTopLayer=this.map.createLayer("map/environment_objects/animated/flag_top_01",this.tileset,0,0),this.flagTopLayer.setVisible(!1),this.flagLowLayer=this.map.createLayer("map/environment_objects/animated/flag_low_03",this.tileset,0,0),this.flagLowLayer.setVisible(!1),this.animatedAppleTrees=this.map.createLayer("map/environment_objects/animated/tree_apple_01",this.tileset,0,0),this.animatedAppleTrees.setVisible(!1),this.bridgeLayer=this.map.createLayer("map/environment_objects/animated/drawbridge_01",this.tileset,0,0),this.bridgeLayer.setVisible(!1),this.riverLayer=this.map.createLayer("map/water/river_00",this.tileset,0,0),this.riverLayer.setVisible(!1);let e=this.sys.settings.key;e===l.LEVEL_01?(this.candyLayer=this.map.createLayer("map/collectables/candies_level1_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level1",this.tileset,0,0)):e===l.LEVEL_02?(this.candyLayer=this.map.createLayer("map/collectables/candies_level2_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level2",this.tileset,0,0)):e===l.LEVEL_03?(this.candyLayer=this.map.createLayer("map/collectables/candies_level3_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level3",this.tileset,0,0)):e===l.LEVEL_04?(this.candyLayer=this.map.createLayer("map/collectables/candies_level4_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level4",this.tileset,0,0)):(this.candyLayer=this.map.createLayer("map/collectables/candies_level1_depth_02",this.tileset,0,0),this.diverLayer=this.map.createLayer("map/patrol/level1",this.tileset,0,0)),this.candyLayer.setDepth(7),this.candyLayer.setVisible(!1),this.diverLayer.setDepth(7),this.diverLayer.setVisible(!1),this.goalLayer=this.map.createLayer("map/goal/goal_depth_02",this.tileset,0,0),this.goalLayer.setDepth(7),this.goalLayer.setVisible(!0)}createSpineObject(e,t,i,s,a,h){let l=this.add.spine(i,s,t,e,!0);return l.scaleX=a,l.scaleY=h,l}initializeAnimationsState(e,t){let i=e.getAnimationList();for(let e=0;e<i.length;e++)t.push(i[e])}changeAnimation(e,t,i){const s=t[i];e.play(s,!0)}trufflesAABB(e){let t=!1;return this.player.getX()-this.tileSize/2<e.x+e.scaleX*e.width&&this.player.getX()+this.tileSize/2>e.x&&this.player.getY()-this.tileSize<e.y+e.scaleY*e.height&&this.player.getY()>e.y&&(t=!0),e.y>this.player.getY()?e.setDepth(1):e.setDepth(-1),t}sortLayers(e,t){Math.abs(e.x-t.x)<e.scaleX*e.width&&Math.abs(e.y-t.y)<e.scaleY*e.height&&(e.y<t.y+t.height*t.scaleY?t.setDepth(e.depth+1):t.setDepth(e.depth-1))}trufflesDiverCollision(e,t){let i=!1;return this.map.worldToTileX(this.player.getX())!=this.map.worldToTileX(e.x)&&this.map.worldToTileX(this.player.getX())!=this.map.worldToTileX(e.x)-1||this.map.worldToTileY(this.player.getY())!=this.map.worldToTileY(e.y)||(i=!0,e.play(_.PUSH,!1),this.player.setPushSpeed(g.PUSH_SPEED),this.time.addEvent({delay:800,callback:this.resetDiverAnimations,callbackScope:this,args:[t]})),e.y>this.player.getY()?e.setDepth(2):e.setDepth(-2),i}resetDiverAnimations(e){this.diverMove[e]>0?this.divers[e].play(_.WALK_DOWN,!0):this.divers[e].play(_.WALK_UP,!0),this.player.setPushSpeed(0)}playChurchBells(e,t,i){let s=Phaser.Math.Between(0,24);12!==s&&6!==s||this.churchBells.play()}fruitAnimations(e,t,i){this.changeAnimation(this.fruit[e],this.fruitAnimationNames,2),this.time.addEvent({delay:1e3,callback:this.fruitDelete,callbackScope:this,args:[e,t,i]})}treeAnimations(e,t,i){let s=Phaser.Math.Between(0,24);for(let e=0;e<this.tree.length;e++)18===s||15===s||12===s||9===s||6===s||3===s?"leaf"!==this.tree[e].getCurrentAnimation().name&&this.tree[e].play("leaf",!0):"idle"!==this.tree[e].getCurrentAnimation().name&&this.tree[e].play("idle",!0);for(let e=0;e<this.apple.length;e++)22===s||20===s||16===s||8===s||4===s||2===s?"leaf"!==this.apple[e].getCurrentAnimation().name&&this.apple[e].play("leaf",!0):"idle"!==this.apple[e].getCurrentAnimation().name&&this.apple[e].play("idle",!0)}fruitDelete(e,t,i){const s=this.map.worldToTileX(this.fruit[e].x),a=this.map.worldToTileY(this.fruit[e].y);this.tile=this.candyLayer.getTileAt(s,a),this.map.removeTile(this.tile),this.fruit[e].removeFromDisplayList(),this.fruitRemaining--}cannonballReset(e){this.cannonball[e].setPosition(this.cannonballPosX[e],this.cannonballPosY[e]=40),this.changeAnimation(this.cannonball[e],this.cannonballAnimationNames,1),this.cannonballMoving[e]=!0}cannonballMove(){for(let e=0;e<this.cannonball.length;e++)this.cannonballMoving[e]&&(this.cannonballPosY[e]+=this.cannonballSpeed,this.cannonball[e].setPosition(this.cannonballPosX[e],this.cannonballPosY[e])),this.cannonballPosY[e]>=655&&(this.time.addEvent({delay:600,callback:this.cannonballReset,callbackScope:this,args:[e]}),this.cannonballMoving[e]&&this.changeAnimation(this.cannonball[e],this.cannonballAnimationNames,2),this.cannonballMoving[e]=!1)}setRecord(e){this.newRecordTime=e,this.hudRecord.play(this.hudRecordAnimationNames[1],!0),this.fetchRecordedTime()}addPoints(e){e>0&&(this.collectablePoints+=e)}fetchRecordedTime(){let e=window.localStorage.getItem("time_"+this.sys.settings.key);null!==e?(this.bestRecordedTime=parseInt(e)||0,0===this.bestRecordedTime&&(this.bestRecordedTime=h.TIME)):this.bestRecordedTime=h.TIME,this.newRecordTime<h.TIME?window.localStorage.setItem("time_"+this.sys.settings.key,this.newRecordTime.toString()):window.localStorage.setItem("time_"+this.sys.settings.key,h.TIME.toString())}fetchRecordedScore(){let e=window.localStorage.getItem("score_"+this.sys.settings.key);this.levelScore=null!==e&&parseInt(e)||0,this.levelScore+=this.collectablePoints,this.collectablePoints=0,window.localStorage.setItem("score_"+this.sys.settings.key,this.levelScore.toString())}gsmUpdate(e,t){this.gameState=a.LEVEL_COMPLETE;let i=this.sys.settings.key;i===l.LEVEL_01?(this.artifact[0].play("pig_fill",!1),this.key[0].play("collected",!0)):i===l.LEVEL_02?(this.artifact[1].play("vase_fill",!1),this.key[1].play("collected",!0)):i===l.LEVEL_03?(this.artifact[2].play("pot_fill",!1),this.key[2].play("collected",!0)):i===l.LEVEL_04?(this.artifact[3].play("alter_fill",!1),this.key[3].play("collected",!0)):l.CREDITS}levelComplete(){this.backingMusic.stop();let e=this.sys.settings.key;e===l.LEVEL_01?this.scene.start(n.ArtiFactOneScene):e===l.LEVEL_02?this.scene.start(n.ArtiFactTwoScene):e===l.LEVEL_03?this.scene.start(n.ArtiFactThreeScene):e===l.LEVEL_04?this.scene.start(n.ArtiFactFourScene):e===l.CREDITS&&this.scene.start(n.CREDITS)}handleDPad(e,t){let i=this.input.activePointer;if(i.isDown){let a=i.x,h=i.y,l=this.dpad.x,n=this.dpad.width,r=this.dpad.y,o=this.dpad.height;this.dpad_down=!1,this.dpad_up=!1,this.dpad_left=!1,this.dpad_right=!1,a<l-n/6&&a>l-S.SCALE*n/2&&(this.dpad_left=!0),a>l+n/6&&a<l+S.SCALE*n/2&&(this.dpad_right=!0),h<r-o/6&&h>r-S.SCALE*o/2&&(this.dpad_up=!0),h>r+o/6&&h<r+S.SCALE*o/2&&(this.dpad_down=!0),this.dpad_down?this.dpad_left?(this.player.getState().handleInput(s.WALK_LEFT,e,t,this.player),this.dpad.play(w.DOWN_LEFT,!0)):this.dpad_right?(this.player.getState().handleInput(s.WALK_RIGHT,e,t,this.player),this.dpad.play(w.DOWN_RIGHT,!0)):(this.player.getState().handleInput(s.WALK_DOWN,e,t,this.player),this.dpad.play(w.DOWN,!0)):this.dpad_up?this.dpad_left?(this.player.getState().handleInput(s.WALK_LEFT,e,t,this.player),this.dpad.play(w.UP_LEFT,!0)):this.dpad_right?(this.player.getState().handleInput(s.WALK_RIGHT,e,t,this.player),this.dpad.play(w.UP_RIGHT,!0)):(this.player.getState().handleInput(s.WALK_UP,e,t,this.player),this.dpad.play(w.UP,!0)):this.dpad_left?(this.player.getState().handleInput(s.WALK_LEFT,e,t,this.player),this.dpad.play(w.LEFT,!0)):this.dpad_right&&(this.player.getState().handleInput(s.WALK_RIGHT,e,t,this.player),this.dpad.play(w.RIGHT,!0))}else this.dpad_down=!1,this.dpad_up=!1,this.dpad_left=!1,this.dpad_right=!1,this.dpad.play(w.IDLE,!0)}}const wt={type:Phaser.WEBGL,dom:{createContainer:!0},backgroundColor:"#FFFFFF",scale:{parent:"three_muses_game",dom:{createContainer:!0},mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,width:1280,height:720},scene:[E,fe,Ye,it,St,v,D,k,I,P,x],plugins:{scene:[{key:"SpinePlugin",plugin:window.SpinePlugin,mapping:"spine"}]},physics:{default:"arcade",arcade:{debug:!1,gravity:{y:400}}}};window.addEventListener("load",(()=>{new Phaser.Game(wt)}))}},i={};function s(e){var a=i[e];if(void 0!==a)return a.exports;var h=i[e]={exports:{}};return t[e].call(h.exports,h,h.exports,s),h.exports}s.m=t,e=[],s.O=(t,i,a,h)=>{if(!i){var l=1/0;for(d=0;d<e.length;d++){for(var[i,a,h]=e[d],n=!0,r=0;r<i.length;r++)(!1&h||l>=h)&&Object.keys(s.O).every((e=>s.O[e](i[r])))?i.splice(r--,1):(n=!1,h<l&&(l=h));if(n){e.splice(d--,1);var o=a();void 0!==o&&(t=o)}}return t}h=h||0;for(var d=e.length;d>0&&e[d-1][2]>h;d--)e[d]=e[d-1];e[d]=[i,a,h]},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={179:0};s.O.j=t=>0===e[t];var t=(t,i)=>{var a,h,[l,n,r]=i,o=0;if(l.some((t=>0!==e[t]))){for(a in n)s.o(n,a)&&(s.m[a]=n[a]);if(r)var d=r(s)}for(t&&t(i);o<l.length;o++)h=l[o],s.o(e,h)&&e[h]&&e[h][0](),e[h]=0;return s.O(d)},i=self.webpackChunkthree_muses_project=self.webpackChunkthree_muses_project||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var a=s.O(void 0,[216],(()=>s(189)));a=s.O(a)})();